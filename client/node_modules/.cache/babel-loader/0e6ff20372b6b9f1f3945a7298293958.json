{"ast":null,"code":"import _toConsumableArray from\"/Users/javierjimenez/cuemeinDeploy/capstone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/javierjimenez/cuemeinDeploy/capstone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _this=this;import React,{useState,useEffect,useRef}from\"react\";// import {Container, Row, Col, Button} from 'react-bootstrap'\nimport\"bootstrap/dist/css/bootstrap.min.css\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faMicrophoneSlash,faCamera}from\"@fortawesome/free-solid-svg-icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var helpers=require(\"./helpers\");var muteYourAudio=helpers.muteYourAudio;var unmuteYourAudio=helpers.unmuteYourAudio;var User=function User(_ref){var user=_ref.user,mute=_ref.mute,_ref$local=_ref.local,local=_ref$local===void 0?\"\":_ref$local;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),videoTracks=_useState2[0],setVideoTracks=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),audioTracks=_useState4[0],setAudioTracks=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),muted=_useState6[0],setMute=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),vmute=_useState8[0],setVmute=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),reaction=_useState10[0],setReaction=_useState10[1];// const [emotion, setEmotion] = useState(null);\n// const [emotion_style, setEmotion_Style] = useState(\"participant-video\");\nvar videoref=useRef();var audioref=useRef();var locals=\"black-box\";console.log(\"User.js\",user.identity);var toggleMute=function toggleMute(muted){setMute(muted);console.log(\"toggle mute\",muted);};var toggleVmute=function toggleVmute(muted){console.log(\"toggleVmute\",muted);setVmute(muted);};var trackpubsToTracks=function trackpubsToTracks(trackMap){return Array.from(trackMap.values()).map(function(publication){return publication.track;}).filter(function(track){return track!==null;});};function attachRemoteDataTrack(div,track){console.log(div);var d=document.getElementById(div);console.log(d,\"user.id DIV\");var dataDiv=document.createElement(\"div\");dataDiv.setAttribute(\"id\",track.sid);dataDiv.setAttribute(\"class\",\"emoji\");d.appendChild(dataDiv);}function animateDataLabel(div,startClass){setTimeout(function(){div.classList.remove(startClass);},5000);div.classList.add(startClass);}function addToRemoteDataLabel(newText,dataTrackSID){var remoteDataLabel=document.getElementById(dataTrackSID);remoteDataLabel.innerHTML=newText;animateDataLabel(remoteDataLabel,\"appear\");}useEffect(function(){setVideoTracks(trackpubsToTracks(user.videoTracks));setAudioTracks(trackpubsToTracks(user.audioTracks));user.videoTracks.forEach(function(track){track.on(\"trackEnabled\",toggleVmute.bind(_this,false));track.on(\"trackDisabled\",toggleVmute.bind(_this,true));});user.audioTracks.forEach(function(track){track.on(\"trackEnabled\",toggleMute.bind(_this,false));track.on(\"trackDisabled\",toggleMute.bind(_this,true));});var trackSubscribed=function trackSubscribed(track){console.log(track,\"track subs\");if(track.kind===\"video\"){setVmute(!track.isEnabled);setVideoTracks(function(videoTracks){return[].concat(_toConsumableArray(videoTracks),[track]);});}else if(track.kind===\"audio\"){setMute(!track.isEnabled);setAudioTracks(function(audioTracks){return[].concat(_toConsumableArray(audioTracks),[track]);});}else if(track.kind==\"data\"){// Registering addToRemoteDataLabel(...) event handler Remote Data Track receive\ntrack.on(\"message\",function(data){console.log(\"DATA REACTION\");console.log(JSON.parse(data).emojiData,track.sid);console.log(JSON.parse(data).user,\"reaction id\");// setReaction(JSON.parse(data).emojiData);\nattachRemoteDataTrack(JSON.parse(data).user,track);addToRemoteDataLabel(JSON.parse(data).emojiData,track.sid);});// Attaching the data track to a display label\n//attachRemoteDataTrack(JSON.parse(data).id, track);\nconsole.log(\"TRACK\");console.log(\"TRACK\",track);}};var trackUnsubscribed=function trackUnsubscribed(track){if(track.kind===\"video\"){setVideoTracks(function(videoTracks){return videoTracks.filter(function(v){return v!==track;});});}else if(track.kind===\"audio\"){setAudioTracks(function(audioTracks){return audioTracks.filter(function(a){return a!==track;});});}// else if (track.kind === \"data\") {\n//   document.getElementById(track.sid).remove();\n// }\n};user.on(\"trackSubscribed\",trackSubscribed);user.on(\"trackUnsubscribed\",trackUnsubscribed);return function(){setVideoTracks([]);setAudioTracks([]);user.removeAllListeners();};},[user]);useEffect(function(){var videoTrack=videoTracks[0];if(videoTrack){console.log(\"User.js attach()\",user.identity);videoTrack.attach(videoref.current);return function(){console.log(\"User.js detach()\",user.identity);videoTrack.detach();};}},[videoTracks]);useEffect(function(){var audioTrack=audioTracks[0];if(audioTrack){audioTrack.attach(audioref.current);return function(){audioTrack.detach();};}},[audioTracks]);if(local===\"i\"){locals=\"participant-video-emptyi\";}else{locals=\"participant-video-empty\";}return/*#__PURE__*/_jsxs(\"div\",{className:\"user-camera\",children:[/*#__PURE__*/_jsx(\"div\",{id:user.sid,className:\"user-camera-reaction\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-camera-box\",children:[vmute?/*#__PURE__*/_jsx(\"div\",{className:\"black-box\",children:\"fds\"}):// <video className={\"participant-video-empty\"} height=\"120\"></video>\n\"\",vmute?/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"empty-icon-video\",icon:faCamera,size:\"2x\"}):// <video className={\"participant-video-empty\"} height=\"120\"></video>\n\"\",vmute?/*#__PURE__*/_jsx(\"video\",{className:locals,width:\"100%\",ref:videoref}):/*#__PURE__*/ // <video className={\"participant-video-empty\"} height=\"120\"></video>\n_jsx(\"video\",{className:\"participant-video\",width:\"100%\",ref:videoref,autoPlay:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"participant-border\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"participant-border-name\",children:user.identity}),muted?/*#__PURE__*/_jsx(\"div\",{className:\"muted-bg\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"muted\",icon:faMicrophoneSlash,size:\"1x\"})}):\"\"]}),mute?/*#__PURE__*/_jsx(\"audio\",{ref:audioref,autoPlay:true,muted:true}):/*#__PURE__*/_jsx(\"audio\",{ref:audioref,autoPlay:true,muted:true})]});};export default User;","map":{"version":3,"sources":["/Users/javierjimenez/cuemeinDeploy/capstone/client/src/components/User.js"],"names":["React","useState","useEffect","useRef","FontAwesomeIcon","faMicrophoneSlash","faCamera","helpers","require","muteYourAudio","unmuteYourAudio","User","user","mute","local","videoTracks","setVideoTracks","audioTracks","setAudioTracks","muted","setMute","vmute","setVmute","reaction","setReaction","videoref","audioref","locals","console","log","identity","toggleMute","toggleVmute","trackpubsToTracks","trackMap","Array","from","values","map","publication","track","filter","attachRemoteDataTrack","div","d","document","getElementById","dataDiv","createElement","setAttribute","sid","appendChild","animateDataLabel","startClass","setTimeout","classList","remove","add","addToRemoteDataLabel","newText","dataTrackSID","remoteDataLabel","innerHTML","forEach","on","bind","trackSubscribed","kind","isEnabled","data","JSON","parse","emojiData","trackUnsubscribed","v","a","removeAllListeners","videoTrack","attach","current","detach","audioTrack"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\n// import {Container, Row, Col, Button} from 'react-bootstrap'\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faMicrophoneSlash, faCamera } from \"@fortawesome/free-solid-svg-icons\";\n\nconst helpers = require(\"./helpers\");\nconst muteYourAudio = helpers.muteYourAudio;\nconst unmuteYourAudio = helpers.unmuteYourAudio;\n\nconst User = ({ user, mute, local = \"\" }) => {\n  const [videoTracks, setVideoTracks] = useState([]);\n  const [audioTracks, setAudioTracks] = useState([]);\n  const [muted, setMute] = useState(false);\n  const [vmute, setVmute] = useState(false);\n  const [reaction, setReaction] = useState(\"\");\n  // const [emotion, setEmotion] = useState(null);\n  // const [emotion_style, setEmotion_Style] = useState(\"participant-video\");\n\n  const videoref = useRef();\n  const audioref = useRef();\n  let locals = \"black-box\";\n\n  console.log(\"User.js\", user.identity);\n\n  const toggleMute = (muted) => {\n    setMute(muted);\n    console.log(\"toggle mute\", muted);\n  };\n\n  const toggleVmute = (muted) => {\n    console.log(\"toggleVmute\", muted);\n    setVmute(muted);\n  };\n\n  const trackpubsToTracks = (trackMap) =>\n    Array.from(trackMap.values())\n      .map((publication) => publication.track)\n      .filter((track) => track !== null);\n\n  function attachRemoteDataTrack(div, track) {\n    console.log(div);\n    let d = document.getElementById(div);\n    console.log(d, \"user.id DIV\");\n    let dataDiv = document.createElement(\"div\");\n    dataDiv.setAttribute(\"id\", track.sid);\n    dataDiv.setAttribute(\"class\", \"emoji\");\n    d.appendChild(dataDiv);\n  }\n  function animateDataLabel(div, startClass) {\n    setTimeout(function () {\n      div.classList.remove(startClass);\n    }, 5000);\n    div.classList.add(startClass);\n  }\n\n  function addToRemoteDataLabel(newText, dataTrackSID) {\n    let remoteDataLabel = document.getElementById(dataTrackSID);\n    remoteDataLabel.innerHTML = newText;\n    animateDataLabel(remoteDataLabel, \"appear\");\n  }\n\n  useEffect(() => {\n    setVideoTracks(trackpubsToTracks(user.videoTracks));\n    setAudioTracks(trackpubsToTracks(user.audioTracks));\n\n    user.videoTracks.forEach((track) => {\n      track.on(\"trackEnabled\", toggleVmute.bind(this, false));\n      track.on(\"trackDisabled\", toggleVmute.bind(this, true));\n    });\n\n    user.audioTracks.forEach((track) => {\n      track.on(\"trackEnabled\", toggleMute.bind(this, false));\n      track.on(\"trackDisabled\", toggleMute.bind(this, true));\n    });\n\n    const trackSubscribed = (track) => {\n      console.log(track, \"track subs\");\n      if (track.kind === \"video\") {\n        setVmute(!track.isEnabled);\n        setVideoTracks((videoTracks) => [...videoTracks, track]);\n      } else if (track.kind === \"audio\") {\n        setMute(!track.isEnabled);\n        setAudioTracks((audioTracks) => [...audioTracks, track]);\n      } else if (track.kind == \"data\") {\n        // Registering addToRemoteDataLabel(...) event handler Remote Data Track receive\n        track.on(\"message\", (data) => {\n          console.log(\"DATA REACTION\");\n          console.log(JSON.parse(data).emojiData, track.sid);\n          console.log(JSON.parse(data).user, \"reaction id\");\n          // setReaction(JSON.parse(data).emojiData);\n          attachRemoteDataTrack(JSON.parse(data).user, track);\n          addToRemoteDataLabel(JSON.parse(data).emojiData, track.sid);\n        });\n        // Attaching the data track to a display label\n        //attachRemoteDataTrack(JSON.parse(data).id, track);\n        console.log(\"TRACK\");\n        console.log(\"TRACK\", track);\n      }\n    };\n\n    const trackUnsubscribed = (track) => {\n      if (track.kind === \"video\") {\n        setVideoTracks((videoTracks) => videoTracks.filter((v) => v !== track));\n      } else if (track.kind === \"audio\") {\n        setAudioTracks((audioTracks) => audioTracks.filter((a) => a !== track));\n      }\n      // else if (track.kind === \"data\") {\n      //   document.getElementById(track.sid).remove();\n      // }\n    };\n\n    user.on(\"trackSubscribed\", trackSubscribed);\n    user.on(\"trackUnsubscribed\", trackUnsubscribed);\n\n    return () => {\n      setVideoTracks([]);\n      setAudioTracks([]);\n      user.removeAllListeners();\n    };\n  }, [user]);\n\n  useEffect(() => {\n    const videoTrack = videoTracks[0];\n    if (videoTrack) {\n      console.log(\"User.js attach()\", user.identity);\n      videoTrack.attach(videoref.current);\n      return () => {\n        console.log(\"User.js detach()\", user.identity);\n        videoTrack.detach();\n      };\n    }\n  }, [videoTracks]);\n\n  useEffect(() => {\n    const audioTrack = audioTracks[0];\n    if (audioTrack) {\n      audioTrack.attach(audioref.current);\n      return () => {\n        audioTrack.detach();\n      };\n    }\n  }, [audioTracks]);\n\n  if (local === \"i\") {\n    locals = \"participant-video-emptyi\";\n  } else {\n    locals = \"participant-video-empty\";\n  }\n\n  return (\n    <div className=\"user-camera\">\n      <div id={user.sid} className=\"user-camera-reaction\"></div>\n\n      <div className=\"user-camera-box\">\n        {vmute ? (\n          <div className=\"black-box\">fds</div>\n        ) : (\n          // <video className={\"participant-video-empty\"} height=\"120\"></video>\n          \"\"\n        )}\n        {vmute ? (\n          <FontAwesomeIcon\n            className={\"empty-icon-video\"}\n            icon={faCamera}\n            size=\"2x\"\n          />\n        ) : (\n          // <video className={\"participant-video-empty\"} height=\"120\"></video>\n          \"\"\n        )}\n\n        {vmute ? (\n          <video className={locals} width=\"100%\" ref={videoref} />\n        ) : (\n          // <video className={\"participant-video-empty\"} height=\"120\"></video>\n          <video\n            className={\"participant-video\"}\n            width=\"100%\"\n            ref={videoref}\n            autoPlay={true}\n          />\n        )}\n      </div>\n\n      <div className=\"participant-border\">\n        <div className=\"participant-border-name\">{user.identity}</div>\n\n        {muted ? (\n          <div className=\"muted-bg\">\n            <FontAwesomeIcon\n              className={\"muted\"}\n              icon={faMicrophoneSlash}\n              size=\"1x\"\n            />\n          </div>\n        ) : (\n          \"\"\n        )}\n      </div>\n      {mute ? (\n        <audio ref={audioref} autoPlay={true} muted />\n      ) : (\n        <audio ref={audioref} autoPlay={true} muted />\n      )}\n    </div>\n  );\n};\n\nexport default User;\n"]},"metadata":{},"sourceType":"module"}