{"ast":null,"code":"'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar MediaTrackTransceiver = require('./transceiver');\n/**\n * A {@link MediaTrackSender} represents one or more local RTCRtpSenders.\n * @extends MediaTrackTransceiver\n */\n\n\nvar MediaTrackSender = function (_super) {\n  __extends(MediaTrackSender, _super);\n  /**\n   * Construct a {@link MediaTrackSender}.\n   * @param {MediaStreamTrack} mediaStreamTrack\n   */\n\n\n  function MediaTrackSender(mediaStreamTrack) {\n    var _this = _super.call(this, mediaStreamTrack.id, mediaStreamTrack) || this;\n\n    Object.defineProperties(_this, {\n      _clones: {\n        value: new Set()\n      },\n      _senders: {\n        value: new Set()\n      },\n      isPublishing: {\n        get: function get() {\n          return !!this._clones.size;\n        }\n      }\n    });\n    return _this;\n  }\n  /**\n   * Return a new {@link MediaTrackSender} containing a clone of the underlying\n   * MediaStreamTrack. No RTCRtpSenders are copied.\n   * @returns {MediaTrackSender}\n   */\n\n\n  MediaTrackSender.prototype.clone = function () {\n    var clone = new MediaTrackSender(this.track.clone());\n\n    this._clones.add(clone);\n\n    return clone;\n  };\n  /**\n   * Remove a cloned {@link MediaTrackSender}.\n   * @returns {void}\n   */\n\n\n  MediaTrackSender.prototype.removeClone = function (clone) {\n    this._clones.delete(clone);\n  };\n  /**\n   * Set the given MediaStreamTrack.\n   * @param {MediaStreamTrack} mediaStreamTrack\n   * @returns {Promise<void>}\n   */\n\n\n  MediaTrackSender.prototype.setMediaStreamTrack = function (mediaStreamTrack) {\n    var _this = this;\n\n    var clones = Array.from(this._clones);\n    var senders = Array.from(this._senders);\n    return Promise.all(clones.map(function (clone) {\n      return clone.setMediaStreamTrack(mediaStreamTrack.clone());\n    }).concat(senders.map(function (sender) {\n      return sender.replaceTrack(mediaStreamTrack);\n    }))).finally(function () {\n      _this._track = mediaStreamTrack;\n    });\n  };\n  /**\n   * Add an RTCRtpSender.\n   * @param {RTCRtpSender} sender\n   * @returns {this}\n   */\n\n\n  MediaTrackSender.prototype.addSender = function (sender) {\n    this._senders.add(sender);\n\n    return this;\n  };\n  /**\n   * Remove an RTCRtpSender.\n   * @param {RTCRtpSender} sender\n   * @returns {this}\n   */\n\n\n  MediaTrackSender.prototype.removeSender = function (sender) {\n    this._senders.delete(sender);\n\n    return this;\n  };\n\n  return MediaTrackSender;\n}(MediaTrackTransceiver);\n\nmodule.exports = MediaTrackSender;","map":{"version":3,"sources":["../../../lib/media/track/sender.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAM,qBAAqB,GAAG,OAAO,CAAC,eAAD,CAArC;AAEA;;;AAGG;;;AACH,IAAA,gBAAA,GAAA,UAAA,MAAA,EAAA;AAA+B,EAAA,SAAA,CAAA,gBAAA,EAAA,MAAA,CAAA;AAC7B;;;AAGG;;;AACH,WAAA,gBAAA,CAAY,gBAAZ,EAA4B;AAA5B,QAAA,KAAA,GACE,MAAA,CAAA,IAAA,CAAA,IAAA,EAAM,gBAAgB,CAAC,EAAvB,EAA2B,gBAA3B,KAA4C,IAD9C;;AAEE,IAAA,MAAM,CAAC,gBAAP,CAAwB,KAAxB,EAA8B;AAC5B,MAAA,OAAO,EAAE;AACP,QAAA,KAAK,EAAE,IAAI,GAAJ;AADA,OADmB;AAI5B,MAAA,QAAQ,EAAE;AACR,QAAA,KAAK,EAAE,IAAI,GAAJ;AADC,OAJkB;AAO5B,MAAA,YAAY,EAAE;AACZ,QAAA,GAAG,EAAA,eAAA;AACD,iBAAO,CAAC,CAAC,KAAK,OAAL,CAAa,IAAtB;AACD;AAHW;AAPc,KAA9B;;AAaD;AAED;;;;AAIG;;;AACH,EAAA,gBAAA,CAAA,SAAA,CAAA,KAAA,GAAA,YAAA;AACE,QAAM,KAAK,GAAG,IAAI,gBAAJ,CAAqB,KAAK,KAAL,CAAW,KAAX,EAArB,CAAd;;AACA,SAAK,OAAL,CAAa,GAAb,CAAiB,KAAjB;;AACA,WAAO,KAAP;AACD,GAJD;AAMA;;;AAGG;;;AACH,EAAA,gBAAA,CAAA,SAAA,CAAA,WAAA,GAAA,UAAY,KAAZ,EAAiB;AACf,SAAK,OAAL,CAAa,MAAb,CAAoB,KAApB;AACD,GAFD;AAIA;;;;AAIG;;;AACH,EAAA,gBAAA,CAAA,SAAA,CAAA,mBAAA,GAAA,UAAoB,gBAApB,EAAoC;AAApC,QAAA,KAAA,GAAA,IAAA;;AACE,QAAM,MAAM,GAAG,KAAK,CAAC,IAAN,CAAW,KAAK,OAAhB,CAAf;AACA,QAAM,OAAO,GAAG,KAAK,CAAC,IAAN,CAAW,KAAK,QAAhB,CAAhB;AACA,WAAO,OAAO,CAAC,GAAR,CAAY,MAAM,CAAC,GAAP,CAAW,UAAA,KAAA,EAAK;AACjC,aAAO,KAAK,CAAC,mBAAN,CAA0B,gBAAgB,CAAC,KAAjB,EAA1B,CAAP;AACD,KAFkB,EAEhB,MAFgB,CAET,OAAO,CAAC,GAAR,CAAY,UAAA,MAAA,EAAM;AAC1B,aAAO,MAAM,CAAC,YAAP,CAAoB,gBAApB,CAAP;AACD,KAFS,CAFS,CAAZ,EAIF,OAJE,CAIM,YAAA;AACX,MAAA,KAAI,CAAC,MAAL,GAAc,gBAAd;AACD,KANM,CAAP;AAOD,GAVD;AAYA;;;;AAIG;;;AACH,EAAA,gBAAA,CAAA,SAAA,CAAA,SAAA,GAAA,UAAU,MAAV,EAAgB;AACd,SAAK,QAAL,CAAc,GAAd,CAAkB,MAAlB;;AACA,WAAO,IAAP;AACD,GAHD;AAKA;;;;AAIG;;;AACH,EAAA,gBAAA,CAAA,SAAA,CAAA,YAAA,GAAA,UAAa,MAAb,EAAmB;AACjB,SAAK,QAAL,CAAc,MAAd,CAAqB,MAArB;;AACA,WAAO,IAAP;AACD,GAHD;;AAIF,SAAA,gBAAA;AAAC,CA7ED,CAA+B,qBAA/B,CAAA;;AA+EA,MAAM,CAAC,OAAP,GAAiB,gBAAjB","sourceRoot":"","sourcesContent":["'use strict';\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar MediaTrackTransceiver = require('./transceiver');\n/**\n * A {@link MediaTrackSender} represents one or more local RTCRtpSenders.\n * @extends MediaTrackTransceiver\n */\nvar MediaTrackSender = /** @class */ (function (_super) {\n    __extends(MediaTrackSender, _super);\n    /**\n     * Construct a {@link MediaTrackSender}.\n     * @param {MediaStreamTrack} mediaStreamTrack\n     */\n    function MediaTrackSender(mediaStreamTrack) {\n        var _this = _super.call(this, mediaStreamTrack.id, mediaStreamTrack) || this;\n        Object.defineProperties(_this, {\n            _clones: {\n                value: new Set()\n            },\n            _senders: {\n                value: new Set()\n            },\n            isPublishing: {\n                get: function () {\n                    return !!this._clones.size;\n                }\n            }\n        });\n        return _this;\n    }\n    /**\n     * Return a new {@link MediaTrackSender} containing a clone of the underlying\n     * MediaStreamTrack. No RTCRtpSenders are copied.\n     * @returns {MediaTrackSender}\n     */\n    MediaTrackSender.prototype.clone = function () {\n        var clone = new MediaTrackSender(this.track.clone());\n        this._clones.add(clone);\n        return clone;\n    };\n    /**\n     * Remove a cloned {@link MediaTrackSender}.\n     * @returns {void}\n     */\n    MediaTrackSender.prototype.removeClone = function (clone) {\n        this._clones.delete(clone);\n    };\n    /**\n     * Set the given MediaStreamTrack.\n     * @param {MediaStreamTrack} mediaStreamTrack\n     * @returns {Promise<void>}\n     */\n    MediaTrackSender.prototype.setMediaStreamTrack = function (mediaStreamTrack) {\n        var _this = this;\n        var clones = Array.from(this._clones);\n        var senders = Array.from(this._senders);\n        return Promise.all(clones.map(function (clone) {\n            return clone.setMediaStreamTrack(mediaStreamTrack.clone());\n        }).concat(senders.map(function (sender) {\n            return sender.replaceTrack(mediaStreamTrack);\n        }))).finally(function () {\n            _this._track = mediaStreamTrack;\n        });\n    };\n    /**\n     * Add an RTCRtpSender.\n     * @param {RTCRtpSender} sender\n     * @returns {this}\n     */\n    MediaTrackSender.prototype.addSender = function (sender) {\n        this._senders.add(sender);\n        return this;\n    };\n    /**\n     * Remove an RTCRtpSender.\n     * @param {RTCRtpSender} sender\n     * @returns {this}\n     */\n    MediaTrackSender.prototype.removeSender = function (sender) {\n        this._senders.delete(sender);\n        return this;\n    };\n    return MediaTrackSender;\n}(MediaTrackTransceiver));\nmodule.exports = MediaTrackSender;\n//# sourceMappingURL=sender.js.map"]},"metadata":{},"sourceType":"script"}