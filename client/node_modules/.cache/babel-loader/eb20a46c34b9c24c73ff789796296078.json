{"ast":null,"code":"'use strict';\n\nvar isNonArrayObject = require('./').isNonArrayObject;\n\nvar _a = require('./constants'),\n    E = _a.typeErrors,\n    clientTrackSwitchOffControl = _a.clientTrackSwitchOffControl,\n    videoContentPreferencesMode = _a.videoContentPreferencesMode,\n    subscriptionMode = _a.subscriptionMode,\n    trackPriority = _a.trackPriority,\n    trackSwitchOffMode = _a.trackSwitchOffMode;\n/**\n * Validate the {@link BandwidthProfileOptions} object.\n * @param {BandwidthProfileOptions} bandwidthProfile\n * @returns {?Error} - null if valid, Error if not.\n */\n\n\nfunction validateBandwidthProfile(bandwidthProfile) {\n  var error = validateObject(bandwidthProfile, 'options.bandwidthProfile');\n\n  if (!bandwidthProfile || error) {\n    return error;\n  }\n\n  error = validateObject(bandwidthProfile.video, 'options.bandwidthProfile.video', [{\n    prop: 'contentPreferencesMode',\n    values: Object.values(videoContentPreferencesMode)\n  }, {\n    prop: 'dominantSpeakerPriority',\n    values: Object.values(trackPriority)\n  }, {\n    prop: 'maxSubscriptionBitrate',\n    type: 'number'\n  }, {\n    prop: 'maxTracks',\n    type: 'number'\n  }, {\n    prop: 'mode',\n    values: Object.values(subscriptionMode)\n  }, {\n    prop: 'clientTrackSwitchOffControl',\n    values: Object.values(clientTrackSwitchOffControl)\n  }, {\n    prop: 'trackSwitchOffMode',\n    values: Object.values(trackSwitchOffMode)\n  }]);\n\n  if (error) {\n    return error;\n  }\n\n  if (bandwidthProfile.video) {\n    // maxTracks is replaced by clientTrackSwitchOffControl.\n    // throw an error if both are specified.\n    if ('maxTracks' in bandwidthProfile.video && 'clientTrackSwitchOffControl' in bandwidthProfile.video) {\n      return new TypeError('options.bandwidthProfile.video.maxTracks is deprecated. Use options.bandwidthProfile.video.clientTrackSwitchOffControl instead.');\n    } // renderDimensions is replaced by contentPreferencesMode.\n    // throw an error if both are specified.\n\n\n    if ('renderDimensions' in bandwidthProfile.video && 'contentPreferencesMode' in bandwidthProfile.video) {\n      return new TypeError('options.bandwidthProfile.video.renderDimensions is deprecated. Use options.bandwidthProfile.video.contentPreferencesMode instead.');\n    }\n\n    return validateRenderDimensions(bandwidthProfile.video.renderDimensions);\n  }\n\n  return null;\n}\n/**\n * Throw if the given track is not a {@link LocalAudioTrack}, a\n * {@link LocalVideoTrack} or a MediaStreamTrack.\n * @param {*} track\n * @param {object} options\n */\n\n\nfunction validateLocalTrack(track, options) {\n  if (!(track instanceof options.LocalAudioTrack || track instanceof options.LocalDataTrack || track instanceof options.LocalVideoTrack || track instanceof options.MediaStreamTrack)) {\n    /* eslint new-cap:0 */\n    throw E.INVALID_TYPE('track', 'LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack');\n  }\n}\n/**\n * Validate an object. An object is valid if it is undefined or a non-null, non-array\n * object whose properties satisfy the specified data-type or value-range requirements.\n * @param {object} object - the object to be validated\n * @param {string} name - the object name to be used to build the error message, if invalid\n * @param {Array<object>} [propChecks] - optional data-type or value-range requirements\n *   for the object's properties\n * @returns {?Error} - null if object is valid, Error if not\n */\n\n\nfunction validateObject(object, name, propChecks) {\n  if (propChecks === void 0) {\n    propChecks = [];\n  } // NOTE(mmalavalli): We determine that an undefined object is valid because this\n  // means the parent object does not contain this object as a property, which is\n  // a valid scenario.\n\n\n  if (typeof object === 'undefined') {\n    return null;\n  } // NOTE(mmalavalli): We determine that if the object is null, or an Array, or\n  // any other non-object type, then it is invalid.\n\n\n  if (object === null || !isNonArrayObject(object)) {\n    return E.INVALID_TYPE(name, 'object');\n  } // NOTE(mmalavalli): We determine that the object is invalid if at least one of\n  // its properties does not satisfy its data-type or value-range requirement.\n\n\n  return propChecks.reduce(function (error, _a) {\n    var prop = _a.prop,\n        type = _a.type,\n        values = _a.values;\n\n    if (error || !(prop in object)) {\n      return error;\n    }\n\n    var value = object[prop];\n\n    if (type && typeof value !== type) {\n      return E.INVALID_TYPE(name + \".\" + prop, type);\n    }\n\n    if (type === 'number' && isNaN(value)) {\n      return E.INVALID_TYPE(name + \".\" + prop, type);\n    }\n\n    if (Array.isArray(values) && !values.includes(value)) {\n      return E.INVALID_VALUE(name + \".\" + prop, values);\n    }\n\n    return error;\n  }, null);\n}\n/**\n * Validates the renderDimensions field to be \"auto\" or {@link VideoRenderDimensions} object.\n * @param {string|VideoRenderDimensions} renderDimensions\n * @returns {?Error} - null if valid, Error if not.\n */\n\n\nfunction validateRenderDimensions(renderDimensions) {\n  var name = 'options.bandwidthProfile.video.renderDimensions';\n  var error = validateObject(renderDimensions, name);\n  return renderDimensions ? error || Object.values(trackPriority).reduce(function (error, prop) {\n    return error || validateObject(renderDimensions[prop], name + \".\" + prop, [{\n      prop: 'height',\n      type: 'number'\n    }, {\n      prop: 'width',\n      type: 'number'\n    }]);\n  }, null) : error;\n}\n\nexports.validateBandwidthProfile = validateBandwidthProfile;\nexports.validateLocalTrack = validateLocalTrack;\nexports.validateObject = validateObject;","map":{"version":3,"sources":["../../lib/util/validate.js"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["'use strict';\nvar isNonArrayObject = require('./').isNonArrayObject;\nvar _a = require('./constants'), E = _a.typeErrors, clientTrackSwitchOffControl = _a.clientTrackSwitchOffControl, videoContentPreferencesMode = _a.videoContentPreferencesMode, subscriptionMode = _a.subscriptionMode, trackPriority = _a.trackPriority, trackSwitchOffMode = _a.trackSwitchOffMode;\n/**\n * Validate the {@link BandwidthProfileOptions} object.\n * @param {BandwidthProfileOptions} bandwidthProfile\n * @returns {?Error} - null if valid, Error if not.\n */\nfunction validateBandwidthProfile(bandwidthProfile) {\n    var error = validateObject(bandwidthProfile, 'options.bandwidthProfile');\n    if (!bandwidthProfile || error) {\n        return error;\n    }\n    error = validateObject(bandwidthProfile.video, 'options.bandwidthProfile.video', [\n        { prop: 'contentPreferencesMode', values: Object.values(videoContentPreferencesMode) },\n        { prop: 'dominantSpeakerPriority', values: Object.values(trackPriority) },\n        { prop: 'maxSubscriptionBitrate', type: 'number' },\n        { prop: 'maxTracks', type: 'number' },\n        { prop: 'mode', values: Object.values(subscriptionMode) },\n        { prop: 'clientTrackSwitchOffControl', values: Object.values(clientTrackSwitchOffControl) },\n        { prop: 'trackSwitchOffMode', values: Object.values(trackSwitchOffMode) }\n    ]);\n    if (error) {\n        return error;\n    }\n    if (bandwidthProfile.video) {\n        // maxTracks is replaced by clientTrackSwitchOffControl.\n        // throw an error if both are specified.\n        if ('maxTracks' in bandwidthProfile.video && 'clientTrackSwitchOffControl' in bandwidthProfile.video) {\n            return new TypeError('options.bandwidthProfile.video.maxTracks is deprecated. Use options.bandwidthProfile.video.clientTrackSwitchOffControl instead.');\n        }\n        // renderDimensions is replaced by contentPreferencesMode.\n        // throw an error if both are specified.\n        if ('renderDimensions' in bandwidthProfile.video && 'contentPreferencesMode' in bandwidthProfile.video) {\n            return new TypeError('options.bandwidthProfile.video.renderDimensions is deprecated. Use options.bandwidthProfile.video.contentPreferencesMode instead.');\n        }\n        return validateRenderDimensions(bandwidthProfile.video.renderDimensions);\n    }\n    return null;\n}\n/**\n * Throw if the given track is not a {@link LocalAudioTrack}, a\n * {@link LocalVideoTrack} or a MediaStreamTrack.\n * @param {*} track\n * @param {object} options\n */\nfunction validateLocalTrack(track, options) {\n    if (!(track instanceof options.LocalAudioTrack\n        || track instanceof options.LocalDataTrack\n        || track instanceof options.LocalVideoTrack\n        || track instanceof options.MediaStreamTrack)) {\n        /* eslint new-cap:0 */\n        throw E.INVALID_TYPE('track', 'LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack');\n    }\n}\n/**\n * Validate an object. An object is valid if it is undefined or a non-null, non-array\n * object whose properties satisfy the specified data-type or value-range requirements.\n * @param {object} object - the object to be validated\n * @param {string} name - the object name to be used to build the error message, if invalid\n * @param {Array<object>} [propChecks] - optional data-type or value-range requirements\n *   for the object's properties\n * @returns {?Error} - null if object is valid, Error if not\n */\nfunction validateObject(object, name, propChecks) {\n    if (propChecks === void 0) { propChecks = []; }\n    // NOTE(mmalavalli): We determine that an undefined object is valid because this\n    // means the parent object does not contain this object as a property, which is\n    // a valid scenario.\n    if (typeof object === 'undefined') {\n        return null;\n    }\n    // NOTE(mmalavalli): We determine that if the object is null, or an Array, or\n    // any other non-object type, then it is invalid.\n    if (object === null || !isNonArrayObject(object)) {\n        return E.INVALID_TYPE(name, 'object');\n    }\n    // NOTE(mmalavalli): We determine that the object is invalid if at least one of\n    // its properties does not satisfy its data-type or value-range requirement.\n    return propChecks.reduce(function (error, _a) {\n        var prop = _a.prop, type = _a.type, values = _a.values;\n        if (error || !(prop in object)) {\n            return error;\n        }\n        var value = object[prop];\n        if (type && typeof value !== type) {\n            return E.INVALID_TYPE(name + \".\" + prop, type);\n        }\n        if (type === 'number' && isNaN(value)) {\n            return E.INVALID_TYPE(name + \".\" + prop, type);\n        }\n        if (Array.isArray(values) && !values.includes(value)) {\n            return E.INVALID_VALUE(name + \".\" + prop, values);\n        }\n        return error;\n    }, null);\n}\n/**\n * Validates the renderDimensions field to be \"auto\" or {@link VideoRenderDimensions} object.\n * @param {string|VideoRenderDimensions} renderDimensions\n * @returns {?Error} - null if valid, Error if not.\n */\nfunction validateRenderDimensions(renderDimensions) {\n    var name = 'options.bandwidthProfile.video.renderDimensions';\n    var error = validateObject(renderDimensions, name);\n    return renderDimensions ? error || Object.values(trackPriority).reduce(function (error, prop) {\n        return error || validateObject(renderDimensions[prop], name + \".\" + prop, [\n            { prop: 'height', type: 'number' },\n            { prop: 'width', type: 'number' }\n        ]);\n    }, null) : error;\n}\nexports.validateBandwidthProfile = validateBandwidthProfile;\nexports.validateLocalTrack = validateLocalTrack;\nexports.validateObject = validateObject;\n//# sourceMappingURL=validate.js.map"]},"metadata":{},"sourceType":"script"}