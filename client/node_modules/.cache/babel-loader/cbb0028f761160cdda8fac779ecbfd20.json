{"ast":null,"code":"import _toConsumableArray from\"/Users/javierjimenez/cuemeinDeploy/capstone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/javierjimenez/cuemeinDeploy/capstone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback}from\"react\";import Video from\"twilio-video\";import User from\"./User\";import DominantUser from\"./DominantUser\";import{Container,Row,Col,Button,Navbar,Nav}from\"react-bootstrap\";import\"bootstrap/dist/css/bootstrap.min.css\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faTimes,faVideoSlash,faMicrophoneSlash,faMicrophone,faDesktop,faVideo,faThumbsUp,faHeadphones,faRssSquare}from\"@fortawesome/free-solid-svg-icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Room=function Room(_ref){var meetingname=_ref.meetingname,token=_ref.token,emotion=_ref.emotion,logout=_ref.logout,test=_ref.test;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),room=_useState2[0],setRoom=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];//create user array here\n//implement\nvar _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),newDomName=_useState6[0],setNewDomName=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),mute=_useState8[0],setMute=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),videomute=_useState10[0],setVideomute=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),deafenmute=_useState12[0],setDeafenmute=_useState12[1];var intervalID;var sentiment_intervalID;// const reaction = require(\"./reaction\");\n// const activateEmojiButtons = reaction.activateEmojiButtons;\n// const addLocalData = reaction.addLocalData;\n// activateEmojiButtons();\n// addLocalData();\n// const dataTrack = reaction.dataTrack;\nvar helpers=require(\"./helpers\");var muteYourAudio=helpers.muteYourAudio;var unmuteYourAudio=helpers.unmuteYourAudio;var _require=require(\"twilio-video\"),LocalDataTrack=_require.LocalDataTrack;console.log(\"Room.js render\");var takeSnapshot=function takeSnapshot(room,users){if(!room.localParticipant.videoTracks.entries().next()){var videoElement=room.localParticipant.videoTracks.entries().next().value[1].track.mediaStreamTrack;var imageCapture=new ImageCapture(videoElement);imageCapture.grabFrame().then(function(bitmap){console.log(\"bitmap :\",bitmap);var canvas=document.createElement(\"canvas\");canvas.width=bitmap.width;canvas.height=bitmap.height;var context=canvas.getContext(\"2d\");context.drawImage(bitmap,0,0);canvas.toBlob(function(blob){// console.log(blob);\nvar reader=new FileReader();reader.addEventListener(\"loadend\",function(){fetch(reader.result).then(function(res){return res.blob();}).then(function(blob){// console.log(\"here is your binary: \", blob);\nfetch(\"/video/snapShot?identity=\"+room.localParticipant.identity+\"&room=\"+room.name,{method:\"POST\",body:blob,headers:{\"Content-Type\":\"application/octet-stream\"}});});});reader.readAsDataURL(blob);},\"image/jpeg\");}).catch(function(error){console.log(\"takePhoto() error: \",error);});}};//passing array here\n//user state = array for rendering\nvar updateUserSentiments=function updateUserSentiments(users){console.log(users);users.forEach(function(u){fetch(\"/video/emotion?identity=\"+u.identity+\"&room=\"+room.name,{method:\"GET\",headers:{\"Content-Type\":\"application/json\"}}).then(function(res){u.emotion=res.body.emotion;});});};var restartSentiment=function restartSentiment(user){if(sentiment_intervalID){window.clearInterval(sentiment_intervalID);}sentiment_intervalID=window.setInterval(updateUserSentiments,10000,user);};useEffect(function(){console.log(\"dominant speacjer Room.js effect\");var participantConnected=function participantConnected(new_user){console.log(\"Room.js - particiapnt connected\",new_user);//add user to array\nsetUser(function(prevusers){return[].concat(_toConsumableArray(prevusers),[new_user]);});restartSentiment(user);};var participantDisconnected=function participantDisconnected(gone_user){console.log(\"Room.js - particiapnt disconnected\",gone_user,user);//remove user from array\nsetUser(function(prevusers){return prevusers.filter(function(p){return p!==gone_user;});});// setUser((prevusers) => prevusers.splice(prevusers.indexOf(gone_user), 1));\nrestartSentiment(user);console.log(user);};var ParticipantNewDominantSpeaker=function ParticipantNewDominantSpeaker(user){if(user!==null){// console.log(\"new dominant speaker Room.js\");\nsetNewDomName(user.identity);}else if(user===null){setNewDomName(null);}};var participantRemoteVideoMuted=function participantRemoteVideoMuted(track,user){// console.log(\"Room.js - Track disable\", track, user);\n};var participantRemotedAudioMuted=function participantRemotedAudioMuted(track,user){};var dataTrack;// add this at the top with the other variable declarations\nfunction addToLocalDataLabel(newText){var localDataLabel=document.getElementById(\"datalocal\");localDataLabel.innerHTML=newText;animateDataLabel(localDataLabel,\"appear\");}function sendDataToRoom(data,id,identity){dataTrack.send(JSON.stringify({emojiData:data,user:id,identity:identity}));}function emojiButtonHandler(event){var emojiButton=event.target;var emojiText=emojiButton.innerHTML;addToLocalDataLabel(emojiText);setRoom(function(currentRoom){console.log(\"id\",currentRoom);sendDataToRoom(emojiText,currentRoom.localParticipant.sid,currentRoom.identity);return currentRoom;});console.log(\"id\",room,\"fdsafsadas\");}function activateEmojiButtons(){var emojiButtonGroup=document.getElementsByClassName(\"emojibuttons\");var emojiButton;for(var i=0;i<emojiButtonGroup.length;i++){emojiButton=emojiButtonGroup[i];emojiButton.addEventListener(\"click\",emojiButtonHandler);}}activateEmojiButtons();function addLocalData(){// Creates a Local Data Track\nvar localDataTrack=new LocalDataTrack();dataTrack=localDataTrack;}addLocalData();function animateDataLabel(div,startClass){setTimeout(function(){div.classList.remove(startClass);},1000);div.classList.add(startClass);}Video.connect(token,{name:meetingname,dominantSpeaker:true,audio:true,video:true}).then(function(room){console.log(\"Room.js - line 59 - video.connect\",room);setRoom(room);// Publishing the local Data Track to the Room\n// room.localParticipant.publishTrack(dataTrack);\n//intervalID = window.setInterval(takeSnapshot, 10000, room,user);\nroom.on(\"participantConnected\",participantConnected);room.on(\"participantDisconnected\",participantDisconnected);room.on(\"dominantSpeakerChanged\",ParticipantNewDominantSpeaker);room.on(\"trackDisabled\",participantRemoteVideoMuted);room.localParticipant.publishTrack(dataTrack);room.participants.forEach(participantConnected);intervalID=window.setInterval(takeSnapshot,50000,room,user);});return function(){if(intervalID){window.clearInterval(intervalID);}setRoom(function(currentRoom){if(currentRoom&&currentRoom.localParticipant.state===\"connected\"){currentRoom.localParticipant.tracks.forEach(function(trackPublication){trackPublication.track.stop();});console.log(\"disconnect!!!!!!\");currentRoom.disconnect();return null;}else{return currentRoom;}});};},[meetingname,token]);var mutecallback=useCallback(function(){console.log(\"called mutecallback, button pressed\");if(mute===false&&room!==null){helpers.muteYourAudio(room);setMute(true);}else if(mute===true&&room!==null){helpers.unmuteYourAudio(room);setMute(false);}},[mute,room]);var mutevideocallback=useCallback(function(){console.log(\"called mutevideocallback, button pressed\");if(videomute===false&&room!==null){helpers.muteYourVideo(room);setVideomute(true);}else if(videomute===true&&room!==null){helpers.unmuteYourVideo(room);setVideomute(false);}},[videomute,room]);var defeancallback=useCallback(function(){console.log(\"called deafencallback, button pressed\");if(deafenmute===false&&room!==null){muteYourAudio(room);setDeafenmute(true);}else if(deafenmute===true&&room!=null){unmuteYourAudio(room);setDeafenmute(false);}},[room,deafenmute]);var logoutcallback=useCallback(function(){console.log(\"testing - line 125!!!!!!\",room);if(room&&room.localParticipant.state===\"connected\"){room.localParticipant.tracks.forEach(function(trackPublication){if(trackPublication.track.kind==\"video\"||trackPublication.track.kind==\"audio\"){trackPublication.track.stop();}});//debugger;\nroom.disconnect();}logout();},[room]);var remoteParticipants=user.map(function(user,index){return/*#__PURE__*/_jsx(User,{user:user,mute:deafenmute},index);});return/*#__PURE__*/_jsxs(\"div\",{className:\"room\",children:[/*#__PURE__*/_jsx(Container,{className:\"cameras\",fluid:\"true\",children:/*#__PURE__*/_jsxs(Row,{className:\"cameras-row\",children:[/*#__PURE__*/_jsxs(Col,{sm:2,className:\"local-participant\",children:[room?/*#__PURE__*/_jsxs(\"div\",{className:\"local-participant-camera\",children:[/*#__PURE__*/_jsx(User,{user:room.localParticipant,mute:deafenmute,local:\"i\"},room.localParticipant.sid),/*#__PURE__*/_jsx(\"div\",{id:\"datalocal\",className:\"emoji\"})]}):\"\",/*#__PURE__*/_jsx(\"div\",{className:\"remote-participants\",children:remoteParticipants})]}),/*#__PURE__*/_jsxs(Col,{sm:10,className:\"dominant\",children:[/*#__PURE__*/_jsx(DominantUser,{className:\"dominant-user\",room:room},\"dominant\"),/*#__PURE__*/_jsx(\"div\",{className:\"dominant-header-bg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dominant-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dominant-header-room\",children:[\"Room Name: \",meetingname]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dominant-header-speaker\",children:[\"Talking: \",newDomName]})]})})]})]})}),/*#__PURE__*/_jsx(Container,{fluid:\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"toolbar\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-items\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logoutbutton\",children:/*#__PURE__*/_jsx(\"button\",{className:\"logoutbutton-btn danger\",onClick:logoutcallback,children:\"LOG OUT\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"btns-toolbar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-audio\",children:mute?/*#__PURE__*/_jsxs(\"button\",{className:\"btn1 info\",onClick:mutecallback,children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn2\",children:\"Mute\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"btnsize\",icon:faMicrophoneSlash})]}):/*#__PURE__*/_jsxs(\"button\",{className:\"btn1 info\",onClick:mutecallback,children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn2\",children:\"Mute\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"btnsize\",icon:faMicrophone})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-video\",children:videomute?/*#__PURE__*/_jsxs(\"button\",{className:\"btn1 info\",onClick:mutevideocallback,children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn2\",children:\"Camera\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"btnsize\",icon:faVideoSlash})]}):/*#__PURE__*/_jsxs(\"button\",{className:\"btn1 info\",onClick:mutevideocallback,children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn2\",children:\"Camera\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"btnsize\",icon:faVideo})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-silence\",children:deafenmute?/*#__PURE__*/_jsxs(\"button\",{className:\"btn1 info\",onClick:defeancallback,children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn2\",children:\"Silence\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"btnsize\",icon:faTimes})]}):/*#__PURE__*/_jsxs(\"button\",{className:\"btn1 info\",onClick:defeancallback,children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn2\",children:\"Silence\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"btnsize\",icon:faHeadphones})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-emoji\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"emojiPanel\",style:{padding:\"1rem\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reaction-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"reaction-label-like\",children:\"Like\"}),/*#__PURE__*/_jsx(\"button\",{id:\"emoji-wink\",className:\"btn3 warning emojibuttons\",style:{marginRight:\"1rem\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"reaction-entity\",children:\"\\uD83D\\uDC4D\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reaction-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"reaction-label-dislike\",children:\"Dislike\"}),/*#__PURE__*/_jsx(\"button\",{id:\"emoji-eyes\",className:\"btn3 warning emojibuttons\",style:{marginRight:\"1rem\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"reaction-entity\",children:\"\\uD83D\\uDC4E\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reaction-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"reaction-label-love\",children:\"Love\"}),/*#__PURE__*/_jsx(\"button\",{id:\"emoji-heart\",className:\"btn3 warning emojibuttons\",style:{marginRight:\"1rem\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"reaction-entity\",children:\"\\u2764\"})})]})]})})]})})})]});};export default Room;","map":{"version":3,"sources":["/Users/javierjimenez/cuemeinDeploy/capstone/src/components/Room.js"],"names":["React","useState","useEffect","useCallback","Video","User","DominantUser","Container","Row","Col","Button","Navbar","Nav","FontAwesomeIcon","faTimes","faVideoSlash","faMicrophoneSlash","faMicrophone","faDesktop","faVideo","faThumbsUp","faHeadphones","faRssSquare","Room","meetingname","token","emotion","logout","test","room","setRoom","user","setUser","newDomName","setNewDomName","mute","setMute","videomute","setVideomute","deafenmute","setDeafenmute","intervalID","sentiment_intervalID","helpers","require","muteYourAudio","unmuteYourAudio","LocalDataTrack","console","log","takeSnapshot","users","localParticipant","videoTracks","entries","next","videoElement","value","track","mediaStreamTrack","imageCapture","ImageCapture","grabFrame","then","bitmap","canvas","document","createElement","width","height","context","getContext","drawImage","toBlob","blob","reader","FileReader","addEventListener","fetch","result","res","identity","name","method","body","headers","readAsDataURL","catch","error","updateUserSentiments","forEach","u","restartSentiment","window","clearInterval","setInterval","participantConnected","new_user","prevusers","participantDisconnected","gone_user","filter","p","ParticipantNewDominantSpeaker","participantRemoteVideoMuted","participantRemotedAudioMuted","dataTrack","addToLocalDataLabel","newText","localDataLabel","getElementById","innerHTML","animateDataLabel","sendDataToRoom","data","id","send","JSON","stringify","emojiData","emojiButtonHandler","event","emojiButton","target","emojiText","currentRoom","sid","activateEmojiButtons","emojiButtonGroup","getElementsByClassName","i","length","addLocalData","localDataTrack","div","startClass","setTimeout","classList","remove","add","connect","dominantSpeaker","audio","video","on","publishTrack","participants","state","tracks","trackPublication","stop","disconnect","mutecallback","mutevideocallback","muteYourVideo","unmuteYourVideo","defeancallback","logoutcallback","kind","remoteParticipants","map","index","padding","marginRight"],"mappings":"4UAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,WAArC,KAAwD,OAAxD,CACA,MAAOC,CAAAA,KAAP,KAAkB,cAAlB,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,OAASC,SAAT,CAAoBC,GAApB,CAAyBC,GAAzB,CAA8BC,MAA9B,CAAsCC,MAAtC,CAA8CC,GAA9C,KAAyD,iBAAzD,CACA,MAAO,sCAAP,CACA,OAASC,eAAT,KAAgC,gCAAhC,CACA,OACEC,OADF,CAEEC,YAFF,CAGEC,iBAHF,CAIEC,YAJF,CAKEC,SALF,CAMEC,OANF,CAOEC,UAPF,CAQEC,YARF,CASEC,WATF,KAUO,mCAVP,C,wFAYA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAmD,IAAhDC,CAAAA,WAAgD,MAAhDA,WAAgD,CAAnCC,KAAmC,MAAnCA,KAAmC,CAA5BC,OAA4B,MAA5BA,OAA4B,CAAnBC,MAAmB,MAAnBA,MAAmB,CAAXC,IAAW,MAAXA,IAAW,CAC9D,cAAwB3B,QAAQ,CAAC,IAAD,CAAhC,wCAAO4B,IAAP,eAAaC,OAAb,eACA,eAAwB7B,QAAQ,CAAC,EAAD,CAAhC,yCAAO8B,IAAP,eAAaC,OAAb,eACA;AACA;AACA,eAAoC/B,QAAQ,CAAC,EAAD,CAA5C,yCAAOgC,UAAP,eAAmBC,aAAnB,eACA,eAAwBjC,QAAQ,CAAC,KAAD,CAAhC,yCAAOkC,IAAP,eAAaC,OAAb,eACA,eAAkCnC,QAAQ,CAAC,KAAD,CAA1C,0CAAOoC,SAAP,gBAAkBC,YAAlB,gBACA,gBAAoCrC,QAAQ,CAAC,KAAD,CAA5C,2CAAOsC,UAAP,gBAAmBC,aAAnB,gBACA,GAAIC,CAAAA,UAAJ,CACA,GAAIC,CAAAA,oBAAJ,CAEA;AACA;AACA;AACA;AACA;AACA;AAEA,GAAMC,CAAAA,OAAO,CAAGC,OAAO,CAAC,WAAD,CAAvB,CACA,GAAMC,CAAAA,aAAa,CAAGF,OAAO,CAACE,aAA9B,CACA,GAAMC,CAAAA,eAAe,CAAGH,OAAO,CAACG,eAAhC,CAEA,aAA2BF,OAAO,gBAAlC,CAAQG,cAAR,UAAQA,cAAR,CAEAC,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACrB,IAAD,CAAOsB,KAAP,CAAiB,CACpC,GAAI,CAACtB,IAAI,CAACuB,gBAAL,CAAsBC,WAAtB,CAAkCC,OAAlC,GAA4CC,IAA5C,EAAL,CAAyD,CACvD,GAAIC,CAAAA,YAAY,CAAG3B,IAAI,CAACuB,gBAAL,CAAsBC,WAAtB,CAAkCC,OAAlC,GAA4CC,IAA5C,GAChBE,KADgB,CACV,CADU,EACPC,KADO,CACDC,gBADlB,CAEA,GAAIC,CAAAA,YAAY,CAAG,GAAIC,CAAAA,YAAJ,CAAiBL,YAAjB,CAAnB,CACAI,YAAY,CACTE,SADH,GAEGC,IAFH,CAEQ,SAACC,MAAD,CAAY,CAChBhB,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAwBe,MAAxB,EACA,GAAIC,CAAAA,MAAM,CAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAb,CACAF,MAAM,CAACG,KAAP,CAAeJ,MAAM,CAACI,KAAtB,CACAH,MAAM,CAACI,MAAP,CAAgBL,MAAM,CAACK,MAAvB,CACA,GAAIC,CAAAA,OAAO,CAAGL,MAAM,CAACM,UAAP,CAAkB,IAAlB,CAAd,CAEAD,OAAO,CAACE,SAAR,CAAkBR,MAAlB,CAA0B,CAA1B,CAA6B,CAA7B,EACAC,MAAM,CAACQ,MAAP,CAAc,SAAUC,IAAV,CAAgB,CAC5B;AACA,GAAIC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAb,CACAD,MAAM,CAACE,gBAAP,CAAwB,SAAxB,CAAmC,UAAM,CACvCC,KAAK,CAACH,MAAM,CAACI,MAAR,CAAL,CACGhB,IADH,CACQ,SAACiB,GAAD,QAASA,CAAAA,GAAG,CAACN,IAAJ,EAAT,EADR,EAEGX,IAFH,CAEQ,SAACW,IAAD,CAAU,CACd;AACAI,KAAK,CACH,4BACEjD,IAAI,CAACuB,gBAAL,CAAsB6B,QADxB,CAEE,QAFF,CAGEpD,IAAI,CAACqD,IAJJ,CAKH,CACEC,MAAM,CAAE,MADV,CAEEC,IAAI,CAAEV,IAFR,CAGEW,OAAO,CAAE,CACP,eAAgB,0BADT,CAHX,CALG,CAAL,CAaD,CAjBH,EAkBD,CAnBD,EAoBAV,MAAM,CAACW,aAAP,CAAqBZ,IAArB,EACD,CAxBD,CAwBG,YAxBH,EAyBD,CAnCH,EAoCGa,KApCH,CAoCS,SAAUC,KAAV,CAAiB,CACtBxC,OAAO,CAACC,GAAR,CAAY,qBAAZ,CAAmCuC,KAAnC,EACD,CAtCH,EAuCD,CACF,CA7CD,CA+CA;AACA;AACA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACtC,KAAD,CAAW,CACtCH,OAAO,CAACC,GAAR,CAAYE,KAAZ,EACAA,KAAK,CAACuC,OAAN,CAAc,SAACC,CAAD,CAAO,CACnBb,KAAK,CAAC,2BAA6Ba,CAAC,CAACV,QAA/B,CAA0C,QAA1C,CAAqDpD,IAAI,CAACqD,IAA3D,CAAiE,CACpEC,MAAM,CAAE,KAD4D,CAEpEE,OAAO,CAAE,CACP,eAAgB,kBADT,CAF2D,CAAjE,CAAL,CAKGtB,IALH,CAKQ,SAACiB,GAAD,CAAS,CACfW,CAAC,CAACjE,OAAF,CAAYsD,GAAG,CAACI,IAAJ,CAAS1D,OAArB,CACD,CAPD,EAQD,CATD,EAUD,CAZD,CAcA,GAAMkE,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAAC7D,IAAD,CAAU,CACjC,GAAIW,oBAAJ,CAA0B,CACxBmD,MAAM,CAACC,aAAP,CAAqBpD,oBAArB,EACD,CACDA,oBAAoB,CAAGmD,MAAM,CAACE,WAAP,CACrBN,oBADqB,CAErB,KAFqB,CAGrB1D,IAHqB,CAAvB,CAKD,CATD,CAWA7B,SAAS,CAAC,UAAM,CACd8C,OAAO,CAACC,GAAR,CAAY,kCAAZ,EAEA,GAAM+C,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,QAAD,CAAc,CACzCjD,OAAO,CAACC,GAAR,CAAY,iCAAZ,CAA+CgD,QAA/C,EACA;AACAjE,OAAO,CAAC,SAACkE,SAAD,qCAAmBA,SAAnB,GAA8BD,QAA9B,IAAD,CAAP,CAEAL,gBAAgB,CAAC7D,IAAD,CAAhB,CACD,CAND,CAQA,GAAMoE,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,CAACC,SAAD,CAAe,CAC7CpD,OAAO,CAACC,GAAR,CAAY,oCAAZ,CAAkDmD,SAAlD,CAA6DrE,IAA7D,EAEA;AACAC,OAAO,CAAC,SAACkE,SAAD,QAAeA,CAAAA,SAAS,CAACG,MAAV,CAAiB,SAACC,CAAD,QAAOA,CAAAA,CAAC,GAAKF,SAAb,EAAjB,CAAf,EAAD,CAAP,CACA;AACAR,gBAAgB,CAAC7D,IAAD,CAAhB,CACAiB,OAAO,CAACC,GAAR,CAAYlB,IAAZ,EACD,CARD,CAUA,GAAMwE,CAAAA,6BAA6B,CAAG,QAAhCA,CAAAA,6BAAgC,CAACxE,IAAD,CAAU,CAC9C,GAAIA,IAAI,GAAK,IAAb,CAAmB,CACjB;AACAG,aAAa,CAACH,IAAI,CAACkD,QAAN,CAAb,CACD,CAHD,IAGO,IAAIlD,IAAI,GAAK,IAAb,CAAmB,CACxBG,aAAa,CAAC,IAAD,CAAb,CACD,CACF,CAPD,CASA,GAAMsE,CAAAA,2BAA2B,CAAG,QAA9BA,CAAAA,2BAA8B,CAAC9C,KAAD,CAAQ3B,IAAR,CAAiB,CACnD;AACD,CAFD,CAIA,GAAM0E,CAAAA,4BAA4B,CAAG,QAA/BA,CAAAA,4BAA+B,CAAC/C,KAAD,CAAQ3B,IAAR,CAAiB,CAAE,CAAxD,CAEA,GAAI2E,CAAAA,SAAJ,CAAe;AAEf,QAASC,CAAAA,mBAAT,CAA6BC,OAA7B,CAAsC,CACpC,GAAIC,CAAAA,cAAc,CAAG3C,QAAQ,CAAC4C,cAAT,CAAwB,WAAxB,CAArB,CACAD,cAAc,CAACE,SAAf,CAA2BH,OAA3B,CACAI,gBAAgB,CAACH,cAAD,CAAiB,QAAjB,CAAhB,CACD,CAED,QAASI,CAAAA,cAAT,CAAwBC,IAAxB,CAA8BC,EAA9B,CAAkClC,QAAlC,CAA4C,CAC1CyB,SAAS,CAACU,IAAV,CACEC,IAAI,CAACC,SAAL,CAAe,CACbC,SAAS,CAAEL,IADE,CAEbnF,IAAI,CAAEoF,EAFO,CAGblC,QAAQ,CAAEA,QAHG,CAAf,CADF,EAOD,CAED,QAASuC,CAAAA,kBAAT,CAA4BC,KAA5B,CAAmC,CACjC,GAAIC,CAAAA,WAAW,CAAGD,KAAK,CAACE,MAAxB,CACA,GAAIC,CAAAA,SAAS,CAAGF,WAAW,CAACX,SAA5B,CACAJ,mBAAmB,CAACiB,SAAD,CAAnB,CAEA9F,OAAO,CAAC,SAAC+F,WAAD,CAAiB,CACvB7E,OAAO,CAACC,GAAR,CAAY,IAAZ,CAAkB4E,WAAlB,EACAZ,cAAc,CACZW,SADY,CAEZC,WAAW,CAACzE,gBAAZ,CAA6B0E,GAFjB,CAGZD,WAAW,CAAC5C,QAHA,CAAd,CAKA,MAAO4C,CAAAA,WAAP,CACD,CARM,CAAP,CASA7E,OAAO,CAACC,GAAR,CAAY,IAAZ,CAAkBpB,IAAlB,CAAwB,YAAxB,EACD,CAED,QAASkG,CAAAA,oBAAT,EAAgC,CAC9B,GAAIC,CAAAA,gBAAgB,CAAG9D,QAAQ,CAAC+D,sBAAT,CAAgC,cAAhC,CAAvB,CACA,GAAIP,CAAAA,WAAJ,CACA,IAAK,GAAIQ,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGF,gBAAgB,CAACG,MAArC,CAA6CD,CAAC,EAA9C,CAAkD,CAChDR,WAAW,CAAGM,gBAAgB,CAACE,CAAD,CAA9B,CACAR,WAAW,CAAC7C,gBAAZ,CAA6B,OAA7B,CAAsC2C,kBAAtC,EACD,CACF,CAEDO,oBAAoB,GAEpB,QAASK,CAAAA,YAAT,EAAwB,CACtB;AACA,GAAIC,CAAAA,cAAc,CAAG,GAAItF,CAAAA,cAAJ,EAArB,CACA2D,SAAS,CAAG2B,cAAZ,CACD,CACDD,YAAY,GAEZ,QAASpB,CAAAA,gBAAT,CAA0BsB,GAA1B,CAA+BC,UAA/B,CAA2C,CACzCC,UAAU,CAAC,UAAY,CACrBF,GAAG,CAACG,SAAJ,CAAcC,MAAd,CAAqBH,UAArB,EACD,CAFS,CAEP,IAFO,CAAV,CAGAD,GAAG,CAACG,SAAJ,CAAcE,GAAd,CAAkBJ,UAAlB,EACD,CAEDnI,KAAK,CAACwI,OAAN,CAAcnH,KAAd,CAAqB,CACnByD,IAAI,CAAE1D,WADa,CAEnBqH,eAAe,CAAE,IAFE,CAGnBC,KAAK,CAAE,IAHY,CAInBC,KAAK,CAAE,IAJY,CAArB,EAKGhF,IALH,CAKQ,SAAClC,IAAD,CAAU,CAChBmB,OAAO,CAACC,GAAR,CAAY,mCAAZ,CAAiDpB,IAAjD,EACAC,OAAO,CAACD,IAAD,CAAP,CACA;AACA;AACA;AACAA,IAAI,CAACmH,EAAL,CAAQ,sBAAR,CAAgChD,oBAAhC,EACAnE,IAAI,CAACmH,EAAL,CAAQ,yBAAR,CAAmC7C,uBAAnC,EACAtE,IAAI,CAACmH,EAAL,CAAQ,wBAAR,CAAkCzC,6BAAlC,EACA1E,IAAI,CAACmH,EAAL,CAAQ,eAAR,CAAyBxC,2BAAzB,EACA3E,IAAI,CAACuB,gBAAL,CAAsB6F,YAAtB,CAAmCvC,SAAnC,EACA7E,IAAI,CAACqH,YAAL,CAAkBxD,OAAlB,CAA0BM,oBAA1B,EACAvD,UAAU,CAAGoD,MAAM,CAACE,WAAP,CAAmB7C,YAAnB,CAAiC,KAAjC,CAAwCrB,IAAxC,CAA8CE,IAA9C,CAAb,CACD,CAlBD,EAoBA,MAAO,WAAM,CACX,GAAIU,UAAJ,CAAgB,CACdoD,MAAM,CAACC,aAAP,CAAqBrD,UAArB,EACD,CACDX,OAAO,CAAC,SAAC+F,WAAD,CAAiB,CACvB,GAAIA,WAAW,EAAIA,WAAW,CAACzE,gBAAZ,CAA6B+F,KAA7B,GAAuC,WAA1D,CAAuE,CACrEtB,WAAW,CAACzE,gBAAZ,CAA6BgG,MAA7B,CAAoC1D,OAApC,CAA4C,SAC1C2D,gBAD0C,CAE1C,CACAA,gBAAgB,CAAC3F,KAAjB,CAAuB4F,IAAvB,GACD,CAJD,EAKAtG,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACA4E,WAAW,CAAC0B,UAAZ,GACA,MAAO,KAAP,CACD,CATD,IASO,CACL,MAAO1B,CAAAA,WAAP,CACD,CACF,CAbM,CAAP,CAcD,CAlBD,CAmBD,CAvIQ,CAuIN,CAACrG,WAAD,CAAcC,KAAd,CAvIM,CAAT,CAyIA,GAAM+H,CAAAA,YAAY,CAAGrJ,WAAW,CAAC,UAAM,CACrC6C,OAAO,CAACC,GAAR,CAAY,qCAAZ,EACA,GAAId,IAAI,GAAK,KAAT,EAAkBN,IAAI,GAAK,IAA/B,CAAqC,CACnCc,OAAO,CAACE,aAAR,CAAsBhB,IAAtB,EACAO,OAAO,CAAC,IAAD,CAAP,CACD,CAHD,IAGO,IAAID,IAAI,GAAK,IAAT,EAAiBN,IAAI,GAAK,IAA9B,CAAoC,CACzCc,OAAO,CAACG,eAAR,CAAwBjB,IAAxB,EACAO,OAAO,CAAC,KAAD,CAAP,CACD,CACF,CAT+B,CAS7B,CAACD,IAAD,CAAON,IAAP,CAT6B,CAAhC,CAWA,GAAM4H,CAAAA,iBAAiB,CAAGtJ,WAAW,CAAC,UAAM,CAC1C6C,OAAO,CAACC,GAAR,CAAY,0CAAZ,EACA,GAAIZ,SAAS,GAAK,KAAd,EAAuBR,IAAI,GAAK,IAApC,CAA0C,CACxCc,OAAO,CAAC+G,aAAR,CAAsB7H,IAAtB,EACAS,YAAY,CAAC,IAAD,CAAZ,CACD,CAHD,IAGO,IAAID,SAAS,GAAK,IAAd,EAAsBR,IAAI,GAAK,IAAnC,CAAyC,CAC9Cc,OAAO,CAACgH,eAAR,CAAwB9H,IAAxB,EACAS,YAAY,CAAC,KAAD,CAAZ,CACD,CACF,CAToC,CASlC,CAACD,SAAD,CAAYR,IAAZ,CATkC,CAArC,CAWA,GAAM+H,CAAAA,cAAc,CAAGzJ,WAAW,CAAC,UAAM,CACvC6C,OAAO,CAACC,GAAR,CAAY,uCAAZ,EACA,GAAIV,UAAU,GAAK,KAAf,EAAwBV,IAAI,GAAK,IAArC,CAA2C,CACzCgB,aAAa,CAAChB,IAAD,CAAb,CACAW,aAAa,CAAC,IAAD,CAAb,CACD,CAHD,IAGO,IAAID,UAAU,GAAK,IAAf,EAAuBV,IAAI,EAAI,IAAnC,CAAyC,CAC9CiB,eAAe,CAACjB,IAAD,CAAf,CACAW,aAAa,CAAC,KAAD,CAAb,CACD,CACF,CATiC,CAS/B,CAACX,IAAD,CAAOU,UAAP,CAT+B,CAAlC,CAWA,GAAMsH,CAAAA,cAAc,CAAG1J,WAAW,CAAC,UAAM,CACvC6C,OAAO,CAACC,GAAR,CAAY,0BAAZ,CAAwCpB,IAAxC,EACA,GAAIA,IAAI,EAAIA,IAAI,CAACuB,gBAAL,CAAsB+F,KAAtB,GAAgC,WAA5C,CAAyD,CACvDtH,IAAI,CAACuB,gBAAL,CAAsBgG,MAAtB,CAA6B1D,OAA7B,CAAqC,SAAU2D,gBAAV,CAA4B,CAC/D,GACEA,gBAAgB,CAAC3F,KAAjB,CAAuBoG,IAAvB,EAA+B,OAA/B,EACAT,gBAAgB,CAAC3F,KAAjB,CAAuBoG,IAAvB,EAA+B,OAFjC,CAGE,CACAT,gBAAgB,CAAC3F,KAAjB,CAAuB4F,IAAvB,GACD,CACF,CAPD,EAQA;AACAzH,IAAI,CAAC0H,UAAL,GACD,CACD5H,MAAM,GACP,CAfiC,CAe/B,CAACE,IAAD,CAf+B,CAAlC,CAiBA,GAAMkI,CAAAA,kBAAkB,CAAGhI,IAAI,CAACiI,GAAL,CAAS,SAACjI,IAAD,CAAOkI,KAAP,qBAClC,KAAC,IAAD,EAAkB,IAAI,CAAElI,IAAxB,CAA8B,IAAI,CAAEQ,UAApC,EAAW0H,KAAX,CADkC,EAAT,CAA3B,CAIA,mBACE,aAAK,SAAS,CAAC,MAAf,wBACE,KAAC,SAAD,EAAW,SAAS,CAAC,SAArB,CAA+B,KAAK,CAAC,MAArC,uBACE,MAAC,GAAD,EAAK,SAAS,CAAC,aAAf,wBACE,MAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,SAAS,CAAC,mBAAtB,WACGpI,IAAI,cACH,aAAK,SAAS,CAAC,0BAAf,wBACE,KAAC,IAAD,EAEE,IAAI,CAAEA,IAAI,CAACuB,gBAFb,CAGE,IAAI,CAAEb,UAHR,CAIE,KAAK,CAAE,GAJT,EACOV,IAAI,CAACuB,gBAAL,CAAsB0E,GAD7B,CADF,cAOE,YAAK,EAAE,CAAC,WAAR,CAAoB,SAAS,CAAC,OAA9B,EAPF,GADG,CAWH,EAZJ,cAcE,YAAK,SAAS,CAAC,qBAAf,UAAsCiC,kBAAtC,EAdF,GADF,cAiBE,MAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,SAAS,CAAC,UAAvB,wBACE,KAAC,YAAD,EACE,SAAS,CAAC,eADZ,CAGE,IAAI,CAAElI,IAHR,EAEO,UAFP,CADF,cAME,YAAK,SAAS,CAAC,oBAAf,uBACE,aAAK,SAAS,CAAC,iBAAf,wBACE,aAAK,SAAS,CAAC,sBAAf,yBACcL,WADd,GADF,cAIE,aAAK,SAAS,CAAC,yBAAf,uBACYS,UADZ,GAJF,GADF,EANF,GAjBF,GADF,EADF,cAsCE,KAAC,SAAD,EAAW,KAAK,CAAC,MAAjB,uBACE,YAAK,SAAS,CAAC,SAAf,uBACE,aAAK,SAAS,CAAC,eAAf,wBACE,YAAK,SAAS,CAAC,cAAf,uBACE,eACE,SAAS,CAAC,yBADZ,CAEE,OAAO,CAAE4H,cAFX,qBADF,EADF,cASE,aAAK,SAAS,CAAC,cAAf,wBACE,YAAK,SAAS,CAAC,WAAf,UACG1H,IAAI,cACH,gBAAQ,SAAS,CAAC,WAAlB,CAA8B,OAAO,CAAEqH,YAAvC,wBACE,aAAM,SAAS,CAAC,MAAhB,kBADF,cAEE,KAAC,eAAD,EACE,SAAS,CAAC,SADZ,CAEE,IAAI,CAAExI,iBAFR,EAFF,GADG,cASH,gBAAQ,SAAS,CAAC,WAAlB,CAA8B,OAAO,CAAEwI,YAAvC,wBACE,aAAM,SAAS,CAAC,MAAhB,kBADF,cAEE,KAAC,eAAD,EAAiB,SAAS,CAAC,SAA3B,CAAqC,IAAI,CAAEvI,YAA3C,EAFF,GAVJ,EADF,cAiBE,YAAK,SAAS,CAAC,WAAf,UACGoB,SAAS,cACR,gBAAQ,SAAS,CAAC,WAAlB,CAA8B,OAAO,CAAEoH,iBAAvC,wBACE,aAAM,SAAS,CAAC,MAAhB,oBADF,cAEE,KAAC,eAAD,EAAiB,SAAS,CAAC,SAA3B,CAAqC,IAAI,CAAE1I,YAA3C,EAFF,GADQ,cAMR,gBAAQ,SAAS,CAAC,WAAlB,CAA8B,OAAO,CAAE0I,iBAAvC,wBACE,aAAM,SAAS,CAAC,MAAhB,oBADF,cAEE,KAAC,eAAD,EAAiB,SAAS,CAAC,SAA3B,CAAqC,IAAI,CAAEtI,OAA3C,EAFF,GAPJ,EAjBF,cA8BE,YAAK,SAAS,CAAC,aAAf,UACGoB,UAAU,cACT,gBAAQ,SAAS,CAAC,WAAlB,CAA8B,OAAO,CAAEqH,cAAvC,wBACE,aAAM,SAAS,CAAC,MAAhB,qBADF,cAEE,KAAC,eAAD,EAAiB,SAAS,CAAC,SAA3B,CAAqC,IAAI,CAAE9I,OAA3C,EAFF,GADS,cAMT,gBAAQ,SAAS,CAAC,WAAlB,CAA8B,OAAO,CAAE8I,cAAvC,wBACE,aAAM,SAAS,CAAC,MAAhB,qBADF,cAEE,KAAC,eAAD,EAAiB,SAAS,CAAC,SAA3B,CAAqC,IAAI,CAAEvI,YAA3C,EAFF,GAPJ,EA9BF,GATF,cAqDE,YAAK,SAAS,CAAC,WAAf,uBACE,aACE,SAAS,CAAC,YADZ,CAEE,KAAK,CAAE,CACL6I,OAAO,CAAE,MADJ,CAFT,wBAME,aAAK,SAAS,CAAC,oBAAf,wBACE,aAAM,SAAS,CAAC,qBAAhB,kBADF,cAEE,eACE,EAAE,CAAC,YADL,CAEE,SAAS,CAAC,2BAFZ,CAGE,KAAK,CAAE,CACLC,WAAW,CAAE,MADR,CAHT,uBAOE,aAAM,SAAS,CAAC,iBAAhB,0BAPF,EAFF,GANF,cAmBE,aAAK,SAAS,CAAC,oBAAf,wBACE,aAAM,SAAS,CAAC,wBAAhB,qBADF,cAEE,eACE,EAAE,CAAC,YADL,CAEE,SAAS,CAAC,2BAFZ,CAGE,KAAK,CAAE,CACLA,WAAW,CAAE,MADR,CAHT,uBAOE,aAAM,SAAS,CAAC,iBAAhB,0BAPF,EAFF,GAnBF,cAgCE,aAAK,SAAS,CAAC,oBAAf,wBACE,aAAM,SAAS,CAAC,qBAAhB,kBADF,cAEE,eACE,EAAE,CAAC,aADL,CAEE,SAAS,CAAC,2BAFZ,CAGE,KAAK,CAAE,CACLA,WAAW,CAAE,MADR,CAHT,uBAOE,aAAM,SAAS,CAAC,iBAAhB,oBAPF,EAFF,GAhCF,GADF,EArDF,GADF,EADF,EAtCF,GADF,CAkJD,CAtbD,CAwbA,cAAe5I,CAAAA,IAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport Video from \"twilio-video\";\nimport User from \"./User\";\nimport DominantUser from \"./DominantUser\";\nimport { Container, Row, Col, Button, Navbar, Nav } from \"react-bootstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faTimes,\n  faVideoSlash,\n  faMicrophoneSlash,\n  faMicrophone,\n  faDesktop,\n  faVideo,\n  faThumbsUp,\n  faHeadphones,\n  faRssSquare,\n} from \"@fortawesome/free-solid-svg-icons\";\n\nconst Room = ({ meetingname, token, emotion, logout, test }) => {\n  const [room, setRoom] = useState(null);\n  const [user, setUser] = useState([]);\n  //create user array here\n  //implement\n  const [newDomName, setNewDomName] = useState(\"\");\n  const [mute, setMute] = useState(false);\n  const [videomute, setVideomute] = useState(false);\n  const [deafenmute, setDeafenmute] = useState(false);\n  var intervalID;\n  var sentiment_intervalID;\n\n  // const reaction = require(\"./reaction\");\n  // const activateEmojiButtons = reaction.activateEmojiButtons;\n  // const addLocalData = reaction.addLocalData;\n  // activateEmojiButtons();\n  // addLocalData();\n  // const dataTrack = reaction.dataTrack;\n\n  const helpers = require(\"./helpers\");\n  const muteYourAudio = helpers.muteYourAudio;\n  const unmuteYourAudio = helpers.unmuteYourAudio;\n\n  const { LocalDataTrack } = require(`twilio-video`);\n\n  console.log(\"Room.js render\");\n\n  const takeSnapshot = (room, users) => {\n    if (!room.localParticipant.videoTracks.entries().next()) {\n      var videoElement = room.localParticipant.videoTracks.entries().next()\n        .value[1].track.mediaStreamTrack;\n      var imageCapture = new ImageCapture(videoElement);\n      imageCapture\n        .grabFrame()\n        .then((bitmap) => {\n          console.log(\"bitmap :\", bitmap);\n          let canvas = document.createElement(\"canvas\");\n          canvas.width = bitmap.width;\n          canvas.height = bitmap.height;\n          let context = canvas.getContext(\"2d\");\n\n          context.drawImage(bitmap, 0, 0);\n          canvas.toBlob(function (blob) {\n            // console.log(blob);\n            var reader = new FileReader();\n            reader.addEventListener(\"loadend\", () => {\n              fetch(reader.result)\n                .then((res) => res.blob())\n                .then((blob) => {\n                  // console.log(\"here is your binary: \", blob);\n                  fetch(\n                    \"/video/snapShot?identity=\" +\n                      room.localParticipant.identity +\n                      \"&room=\" +\n                      room.name,\n                    {\n                      method: \"POST\",\n                      body: blob,\n                      headers: {\n                        \"Content-Type\": \"application/octet-stream\",\n                      },\n                    }\n                  );\n                });\n            });\n            reader.readAsDataURL(blob);\n          }, \"image/jpeg\");\n        })\n        .catch(function (error) {\n          console.log(\"takePhoto() error: \", error);\n        });\n    }\n  };\n\n  //passing array here\n  //user state = array for rendering\n  const updateUserSentiments = (users) => {\n    console.log(users);\n    users.forEach((u) => {\n      fetch(\"/video/emotion?identity=\" + u.identity + \"&room=\" + room.name, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      }).then((res) => {\n        u.emotion = res.body.emotion;\n      });\n    });\n  };\n\n  const restartSentiment = (user) => {\n    if (sentiment_intervalID) {\n      window.clearInterval(sentiment_intervalID);\n    }\n    sentiment_intervalID = window.setInterval(\n      updateUserSentiments,\n      10000,\n      user\n    );\n  };\n\n  useEffect(() => {\n    console.log(\"dominant speacjer Room.js effect\");\n\n    const participantConnected = (new_user) => {\n      console.log(\"Room.js - particiapnt connected\", new_user);\n      //add user to array\n      setUser((prevusers) => [...prevusers, new_user]);\n\n      restartSentiment(user);\n    };\n\n    const participantDisconnected = (gone_user) => {\n      console.log(\"Room.js - particiapnt disconnected\", gone_user, user);\n\n      //remove user from array\n      setUser((prevusers) => prevusers.filter((p) => p !== gone_user));\n      // setUser((prevusers) => prevusers.splice(prevusers.indexOf(gone_user), 1));\n      restartSentiment(user);\n      console.log(user);\n    };\n\n    const ParticipantNewDominantSpeaker = (user) => {\n      if (user !== null) {\n        // console.log(\"new dominant speaker Room.js\");\n        setNewDomName(user.identity);\n      } else if (user === null) {\n        setNewDomName(null);\n      }\n    };\n\n    const participantRemoteVideoMuted = (track, user) => {\n      // console.log(\"Room.js - Track disable\", track, user);\n    };\n\n    const participantRemotedAudioMuted = (track, user) => {};\n\n    let dataTrack; // add this at the top with the other variable declarations\n\n    function addToLocalDataLabel(newText) {\n      let localDataLabel = document.getElementById(\"datalocal\");\n      localDataLabel.innerHTML = newText;\n      animateDataLabel(localDataLabel, \"appear\");\n    }\n\n    function sendDataToRoom(data, id, identity) {\n      dataTrack.send(\n        JSON.stringify({\n          emojiData: data,\n          user: id,\n          identity: identity,\n        })\n      );\n    }\n\n    function emojiButtonHandler(event) {\n      let emojiButton = event.target;\n      let emojiText = emojiButton.innerHTML;\n      addToLocalDataLabel(emojiText);\n\n      setRoom((currentRoom) => {\n        console.log(\"id\", currentRoom);\n        sendDataToRoom(\n          emojiText,\n          currentRoom.localParticipant.sid,\n          currentRoom.identity\n        );\n        return currentRoom;\n      });\n      console.log(\"id\", room, \"fdsafsadas\");\n    }\n\n    function activateEmojiButtons() {\n      let emojiButtonGroup = document.getElementsByClassName(\"emojibuttons\");\n      let emojiButton;\n      for (let i = 0; i < emojiButtonGroup.length; i++) {\n        emojiButton = emojiButtonGroup[i];\n        emojiButton.addEventListener(\"click\", emojiButtonHandler);\n      }\n    }\n\n    activateEmojiButtons();\n\n    function addLocalData() {\n      // Creates a Local Data Track\n      var localDataTrack = new LocalDataTrack();\n      dataTrack = localDataTrack;\n    }\n    addLocalData();\n\n    function animateDataLabel(div, startClass) {\n      setTimeout(function () {\n        div.classList.remove(startClass);\n      }, 1000);\n      div.classList.add(startClass);\n    }\n\n    Video.connect(token, {\n      name: meetingname,\n      dominantSpeaker: true,\n      audio: true,\n      video: true,\n    }).then((room) => {\n      console.log(\"Room.js - line 59 - video.connect\", room);\n      setRoom(room);\n      // Publishing the local Data Track to the Room\n      // room.localParticipant.publishTrack(dataTrack);\n      //intervalID = window.setInterval(takeSnapshot, 10000, room,user);\n      room.on(\"participantConnected\", participantConnected);\n      room.on(\"participantDisconnected\", participantDisconnected);\n      room.on(\"dominantSpeakerChanged\", ParticipantNewDominantSpeaker);\n      room.on(\"trackDisabled\", participantRemoteVideoMuted);\n      room.localParticipant.publishTrack(dataTrack);\n      room.participants.forEach(participantConnected);\n      intervalID = window.setInterval(takeSnapshot, 50000, room, user);\n    });\n\n    return () => {\n      if (intervalID) {\n        window.clearInterval(intervalID);\n      }\n      setRoom((currentRoom) => {\n        if (currentRoom && currentRoom.localParticipant.state === \"connected\") {\n          currentRoom.localParticipant.tracks.forEach(function (\n            trackPublication\n          ) {\n            trackPublication.track.stop();\n          });\n          console.log(\"disconnect!!!!!!\");\n          currentRoom.disconnect();\n          return null;\n        } else {\n          return currentRoom;\n        }\n      });\n    };\n  }, [meetingname, token]);\n\n  const mutecallback = useCallback(() => {\n    console.log(\"called mutecallback, button pressed\");\n    if (mute === false && room !== null) {\n      helpers.muteYourAudio(room);\n      setMute(true);\n    } else if (mute === true && room !== null) {\n      helpers.unmuteYourAudio(room);\n      setMute(false);\n    }\n  }, [mute, room]);\n\n  const mutevideocallback = useCallback(() => {\n    console.log(\"called mutevideocallback, button pressed\");\n    if (videomute === false && room !== null) {\n      helpers.muteYourVideo(room);\n      setVideomute(true);\n    } else if (videomute === true && room !== null) {\n      helpers.unmuteYourVideo(room);\n      setVideomute(false);\n    }\n  }, [videomute, room]);\n\n  const defeancallback = useCallback(() => {\n    console.log(\"called deafencallback, button pressed\");\n    if (deafenmute === false && room !== null) {\n      muteYourAudio(room);\n      setDeafenmute(true);\n    } else if (deafenmute === true && room != null) {\n      unmuteYourAudio(room);\n      setDeafenmute(false);\n    }\n  }, [room, deafenmute]);\n\n  const logoutcallback = useCallback(() => {\n    console.log(\"testing - line 125!!!!!!\", room);\n    if (room && room.localParticipant.state === \"connected\") {\n      room.localParticipant.tracks.forEach(function (trackPublication) {\n        if (\n          trackPublication.track.kind == \"video\" ||\n          trackPublication.track.kind == \"audio\"\n        ) {\n          trackPublication.track.stop();\n        }\n      });\n      //debugger;\n      room.disconnect();\n    }\n    logout();\n  }, [room]);\n\n  const remoteParticipants = user.map((user, index) => (\n    <User key={index} user={user} mute={deafenmute} />\n  ));\n\n  return (\n    <div className=\"room\">\n      <Container className=\"cameras\" fluid=\"true\">\n        <Row className=\"cameras-row\">\n          <Col sm={2} className=\"local-participant\">\n            {room ? (\n              <div className=\"local-participant-camera\">\n                <User\n                  key={room.localParticipant.sid}\n                  user={room.localParticipant}\n                  mute={deafenmute}\n                  local={\"i\"}\n                />\n                <div id=\"datalocal\" className=\"emoji\"></div>\n              </div>\n            ) : (\n              \"\"\n            )}\n            <div className=\"remote-participants\">{remoteParticipants}</div>\n          </Col>\n          <Col sm={10} className=\"dominant\">\n            <DominantUser\n              className=\"dominant-user\"\n              key={\"dominant\"}\n              room={room}\n            />\n            <div className=\"dominant-header-bg\">\n              <div className=\"dominant-header\">\n                <div className=\"dominant-header-room\">\n                  Room Name: {meetingname}\n                </div>\n                <div className=\"dominant-header-speaker\">\n                  Talking: {newDomName}\n                </div>\n              </div>\n            </div>\n          </Col>\n        </Row>\n      </Container>\n      <Container fluid=\"true\">\n        <div className=\"toolbar\">\n          <div className=\"toolbar-items\">\n            <div className=\"logoutbutton\">\n              <button\n                className=\"logoutbutton-btn danger\"\n                onClick={logoutcallback}\n              >\n                LOG OUT\n              </button>\n            </div>\n            <div className=\"btns-toolbar\">\n              <div className=\"col-audio\">\n                {mute ? (\n                  <button className=\"btn1 info\" onClick={mutecallback}>\n                    <span className=\"btn2\">Mute</span>\n                    <FontAwesomeIcon\n                      className=\"btnsize\"\n                      icon={faMicrophoneSlash}\n                    />\n                  </button>\n                ) : (\n                  <button className=\"btn1 info\" onClick={mutecallback}>\n                    <span className=\"btn2\">Mute</span>\n                    <FontAwesomeIcon className=\"btnsize\" icon={faMicrophone} />\n                  </button>\n                )}\n              </div>\n              <div className=\"col-video\">\n                {videomute ? (\n                  <button className=\"btn1 info\" onClick={mutevideocallback}>\n                    <span className=\"btn2\">Camera</span>\n                    <FontAwesomeIcon className=\"btnsize\" icon={faVideoSlash} />\n                  </button>\n                ) : (\n                  <button className=\"btn1 info\" onClick={mutevideocallback}>\n                    <span className=\"btn2\">Camera</span>\n                    <FontAwesomeIcon className=\"btnsize\" icon={faVideo} />\n                  </button>\n                )}\n              </div>\n              <div className=\"col-silence\">\n                {deafenmute ? (\n                  <button className=\"btn1 info\" onClick={defeancallback}>\n                    <span className=\"btn2\">Silence</span>\n                    <FontAwesomeIcon className=\"btnsize\" icon={faTimes} />\n                  </button>\n                ) : (\n                  <button className=\"btn1 info\" onClick={defeancallback}>\n                    <span className=\"btn2\">Silence</span>\n                    <FontAwesomeIcon className=\"btnsize\" icon={faHeadphones} />\n                  </button>\n                )}\n              </div>\n            </div>\n            <div className=\"col-emoji\">\n              <div\n                className=\"emojiPanel\"\n                style={{\n                  padding: \"1rem\",\n                }}\n              >\n                <div className=\"reaction-container\">\n                  <span className=\"reaction-label-like\">Like</span>\n                  <button\n                    id=\"emoji-wink\"\n                    className=\"btn3 warning emojibuttons\"\n                    style={{\n                      marginRight: \"1rem\",\n                    }}\n                  >\n                    <span className=\"reaction-entity\">&#128077;</span>\n                  </button>\n                </div>\n\n                <div className=\"reaction-container\">\n                  <span className=\"reaction-label-dislike\">Dislike</span>\n                  <button\n                    id=\"emoji-eyes\"\n                    className=\"btn3 warning emojibuttons\"\n                    style={{\n                      marginRight: \"1rem\",\n                    }}\n                  >\n                    <span className=\"reaction-entity\">&#128078;</span>\n                  </button>\n                </div>\n\n                <div className=\"reaction-container\">\n                  <span className=\"reaction-label-love\">Love</span>\n                  <button\n                    id=\"emoji-heart\"\n                    className=\"btn3 warning emojibuttons\"\n                    style={{\n                      marginRight: \"1rem\",\n                    }}\n                  >\n                    <span className=\"reaction-entity\">&#10084;</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Container>\n    </div>\n  );\n};\n\nexport default Room;\n"]},"metadata":{},"sourceType":"module"}