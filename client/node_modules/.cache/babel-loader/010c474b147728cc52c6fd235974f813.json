{"ast":null,"code":"'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar average = require('./average');\n\nvar SenderOrReceiverReport = require('./senderorreceiverreport');\n\nvar sum = require('./sum');\n/**\n * @interface ReceiverSummary\n * @property {number} bitrate\n * @property {number} fractionLost - 0–1\n * @property {number} [jitter] - s (undefined for video tracks in Chrome)\n */\n\n/**\n * @extends SenderOrReceiverReport\n * @property {number} deltaPacketsLost\n * @property {number} deltaPacketsReceived\n * @property {number} [fractionLost] - 0–1 (undefined in Firefox)\n * @property {number} [jitter] - s (undefined for video tracks in Chrome)\n * @property {number} phonyPacketsLost - 0–1\n */\n\n\nvar ReceiverReport = function (_super) {\n  __extends(ReceiverReport, _super);\n  /**\n   * @param {StatsId} id\n   * @param {TrackId} trackId\n   * @param {number} bitrate - bps\n   * @param {number} deltaPacketsLost\n   * @param {number} deltaPacketsReceived\n   * @param {number} [fractionLost] - 0–1 (undefined in Firefox)\n   * @param {number} [jitter] - s (undefined for video tracks in Chrome)\n   */\n\n\n  function ReceiverReport(id, trackId, bitrate, deltaPacketsLost, deltaPacketsReceived, fractionLost, jitter) {\n    var _this = _super.call(this, id, trackId, bitrate) || this;\n\n    var phonyFractionLost = deltaPacketsReceived > 0 ? deltaPacketsLost / deltaPacketsReceived : 0;\n    Object.defineProperties(_this, {\n      deltaPacketsLost: {\n        enumerable: true,\n        value: deltaPacketsLost\n      },\n      deltaPacketsReceived: {\n        enumerable: true,\n        value: deltaPacketsReceived\n      },\n      fractionLost: {\n        enumerable: true,\n        value: fractionLost\n      },\n      jitter: {\n        enumerable: true,\n        value: jitter\n      },\n      phonyFractionLost: {\n        enumerable: true,\n        value: phonyFractionLost\n      }\n    });\n    return _this;\n  }\n  /**\n   * Create a {@link ReceiverReport}.\n   * @param {string} trackId\n   * @param {RTCStats} olderStats\n   * @param {RTCStats} newerStats\n   * @returns {ReceiverReport}\n   */\n\n\n  ReceiverReport.of = function (trackId, olderStats, newerStats) {\n    if (olderStats.id !== newerStats.id) {\n      throw new Error('RTCStats IDs must match');\n    }\n\n    var secondsElapsed = (newerStats.timestamp - olderStats.timestamp) / 1000;\n    var deltaBytesReceived = newerStats.bytesReceived - olderStats.bytesReceived;\n    var bitrate = secondsElapsed > 0 ? deltaBytesReceived / secondsElapsed * 8 : 0;\n    var deltaPacketsLost = Math.max(newerStats.packetsLost - olderStats.packetsLost, 0);\n    var deltaPacketsReceived = newerStats.packetsReceived - olderStats.packetsReceived;\n    var fractionLost = newerStats.fractionLost,\n        jitter = newerStats.jitter;\n    return new ReceiverReport(olderStats.id, trackId, bitrate, deltaPacketsLost, deltaPacketsReceived, fractionLost, jitter);\n  };\n  /**\n   * Summarize {@link ReceiverReport}s by summing and averaging their values.\n   * @param {Array<ReceiverReport>} reports\n   * @returns {ReceiverSummary}\n   */\n\n\n  ReceiverReport.summarize = function (reports) {\n    var summaries = reports.map(function (report) {\n      return report.summarize();\n    });\n    var bitrate = sum(summaries.map(function (summary) {\n      return summary.bitrate;\n    }));\n    var fractionLost = average(summaries.map(function (summary) {\n      return summary.fractionLost;\n    }));\n    var jitter = average(summaries.map(function (summary) {\n      return summary.jitter;\n    }));\n    return {\n      bitrate: bitrate,\n      fractionLost: fractionLost,\n      jitter: jitter\n    };\n  };\n  /**\n   * Summarize the {@link ReceiveReport}.\n   * @returns {ReceiverSummary}\n   */\n\n\n  ReceiverReport.prototype.summarize = function () {\n    return {\n      bitrate: this.bitrate,\n      fractionLost: typeof this.fractionLost === 'number' ? this.fractionLost : this.phonyFractionLost,\n      jitter: this.jitter\n    };\n  };\n\n  return ReceiverReport;\n}(SenderOrReceiverReport);\n\nmodule.exports = ReceiverReport;","map":{"version":3,"sources":["../../lib/stats/receiverreport.js"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["'use strict';\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar average = require('./average');\nvar SenderOrReceiverReport = require('./senderorreceiverreport');\nvar sum = require('./sum');\n/**\n * @interface ReceiverSummary\n * @property {number} bitrate\n * @property {number} fractionLost - 0–1\n * @property {number} [jitter] - s (undefined for video tracks in Chrome)\n */\n/**\n * @extends SenderOrReceiverReport\n * @property {number} deltaPacketsLost\n * @property {number} deltaPacketsReceived\n * @property {number} [fractionLost] - 0–1 (undefined in Firefox)\n * @property {number} [jitter] - s (undefined for video tracks in Chrome)\n * @property {number} phonyPacketsLost - 0–1\n */\nvar ReceiverReport = /** @class */ (function (_super) {\n    __extends(ReceiverReport, _super);\n    /**\n     * @param {StatsId} id\n     * @param {TrackId} trackId\n     * @param {number} bitrate - bps\n     * @param {number} deltaPacketsLost\n     * @param {number} deltaPacketsReceived\n     * @param {number} [fractionLost] - 0–1 (undefined in Firefox)\n     * @param {number} [jitter] - s (undefined for video tracks in Chrome)\n     */\n    function ReceiverReport(id, trackId, bitrate, deltaPacketsLost, deltaPacketsReceived, fractionLost, jitter) {\n        var _this = _super.call(this, id, trackId, bitrate) || this;\n        var phonyFractionLost = deltaPacketsReceived > 0\n            ? deltaPacketsLost / deltaPacketsReceived\n            : 0;\n        Object.defineProperties(_this, {\n            deltaPacketsLost: {\n                enumerable: true,\n                value: deltaPacketsLost\n            },\n            deltaPacketsReceived: {\n                enumerable: true,\n                value: deltaPacketsReceived\n            },\n            fractionLost: {\n                enumerable: true,\n                value: fractionLost\n            },\n            jitter: {\n                enumerable: true,\n                value: jitter\n            },\n            phonyFractionLost: {\n                enumerable: true,\n                value: phonyFractionLost\n            }\n        });\n        return _this;\n    }\n    /**\n     * Create a {@link ReceiverReport}.\n     * @param {string} trackId\n     * @param {RTCStats} olderStats\n     * @param {RTCStats} newerStats\n     * @returns {ReceiverReport}\n     */\n    ReceiverReport.of = function (trackId, olderStats, newerStats) {\n        if (olderStats.id !== newerStats.id) {\n            throw new Error('RTCStats IDs must match');\n        }\n        var secondsElapsed = (newerStats.timestamp - olderStats.timestamp) / 1000;\n        var deltaBytesReceived = newerStats.bytesReceived - olderStats.bytesReceived;\n        var bitrate = secondsElapsed > 0\n            ? (deltaBytesReceived / secondsElapsed) * 8\n            : 0;\n        var deltaPacketsLost = Math.max(newerStats.packetsLost - olderStats.packetsLost, 0);\n        var deltaPacketsReceived = newerStats.packetsReceived - olderStats.packetsReceived;\n        var fractionLost = newerStats.fractionLost, jitter = newerStats.jitter;\n        return new ReceiverReport(olderStats.id, trackId, bitrate, deltaPacketsLost, deltaPacketsReceived, fractionLost, jitter);\n    };\n    /**\n     * Summarize {@link ReceiverReport}s by summing and averaging their values.\n     * @param {Array<ReceiverReport>} reports\n     * @returns {ReceiverSummary}\n     */\n    ReceiverReport.summarize = function (reports) {\n        var summaries = reports.map(function (report) { return report.summarize(); });\n        var bitrate = sum(summaries.map(function (summary) { return summary.bitrate; }));\n        var fractionLost = average(summaries.map(function (summary) { return summary.fractionLost; }));\n        var jitter = average(summaries.map(function (summary) { return summary.jitter; }));\n        return {\n            bitrate: bitrate,\n            fractionLost: fractionLost,\n            jitter: jitter\n        };\n    };\n    /**\n     * Summarize the {@link ReceiveReport}.\n     * @returns {ReceiverSummary}\n     */\n    ReceiverReport.prototype.summarize = function () {\n        return {\n            bitrate: this.bitrate,\n            fractionLost: typeof this.fractionLost === 'number' ? this.fractionLost : this.phonyFractionLost,\n            jitter: this.jitter\n        };\n    };\n    return ReceiverReport;\n}(SenderOrReceiverReport));\nmodule.exports = ReceiverReport;\n//# sourceMappingURL=receiverreport.js.map"]},"metadata":{},"sourceType":"script"}