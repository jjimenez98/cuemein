{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.syntheticAudio = void 0;\n\nfunction syntheticAudio() {\n  // NOTE(mpatwardhan): We have to delay require-ing AudioContextFactory, because\n  // it exports a default instance whose constructor calls Object.assign.\n  var audioContextFactory = require('../webaudio/audiocontext');\n\n  var holder = {};\n  var audioContext = audioContextFactory.getOrCreate(holder);\n  var oscillator = audioContext.createOscillator();\n  var dst = oscillator.connect(audioContext.createMediaStreamDestination());\n  oscillator.start();\n  var track = dst.stream.getAudioTracks()[0];\n  var originalStop = track.stop;\n\n  track.stop = function () {\n    originalStop.call(track);\n    audioContextFactory.release(holder);\n  };\n\n  return track;\n}\n\nexports.syntheticAudio = syntheticAudio;","map":{"version":3,"sources":["../../lib/preflight/syntheticaudio.ts"],"names":[],"mappings":";;;;;;;AAIA,SAAgB,cAAhB,GAA8B;AAC5B;AACA;AACA,MAAM,mBAAmB,GAAG,OAAO,CAAC,0BAAD,CAAnC;;AACA,MAAM,MAAM,GAAG,EAAf;AACA,MAAM,YAAY,GAAG,mBAAmB,CAAC,WAApB,CAAgC,MAAhC,CAArB;AACA,MAAM,UAAU,GAAG,YAAY,CAAC,gBAAb,EAAnB;AACA,MAAM,GAAG,GAAG,UAAU,CAAC,OAAX,CAAmB,YAAY,CAAC,4BAAb,EAAnB,CAAZ;AACA,EAAA,UAAU,CAAC,KAAX;AACA,MAAM,KAAK,GAAG,GAAG,CAAC,MAAJ,CAAW,cAAX,GAA4B,CAA5B,CAAd;AACA,MAAM,YAAY,GAAG,KAAK,CAAC,IAA3B;;AACA,EAAA,KAAK,CAAC,IAAN,GAAa,YAAA;AACX,IAAA,YAAY,CAAC,IAAb,CAAkB,KAAlB;AACA,IAAA,mBAAmB,CAAC,OAApB,CAA4B,MAA5B;AACD,GAHD;;AAIA,SAAO,KAAP;AACD;;AAhBD,OAAA,CAAA,cAAA,GAAA,cAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.syntheticAudio = void 0;\nfunction syntheticAudio() {\n    // NOTE(mpatwardhan): We have to delay require-ing AudioContextFactory, because\n    // it exports a default instance whose constructor calls Object.assign.\n    var audioContextFactory = require('../webaudio/audiocontext');\n    var holder = {};\n    var audioContext = audioContextFactory.getOrCreate(holder);\n    var oscillator = audioContext.createOscillator();\n    var dst = oscillator.connect(audioContext.createMediaStreamDestination());\n    oscillator.start();\n    var track = dst.stream.getAudioTracks()[0];\n    var originalStop = track.stop;\n    track.stop = function () {\n        originalStop.call(track);\n        audioContextFactory.release(holder);\n    };\n    return track;\n}\nexports.syntheticAudio = syntheticAudio;\n//# sourceMappingURL=syntheticaudio.js.map"]},"metadata":{},"sourceType":"script"}